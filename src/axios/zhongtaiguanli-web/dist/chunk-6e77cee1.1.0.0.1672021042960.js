(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e77cee1"],{"0164":function(t,e,a){},"096b":function(t,e,a){"use strict";a("2c96")},"112f":function(t,e,a){},"2c96":function(t,e,a){},3213:function(t,e,a){},"43a7":function(t,e,a){"use strict";a("efec")},"6e09":function(t,e,a){"use strict";a("b265")},"736f":function(t,e,a){},8478:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"box"},[a("div",[a("span",{class:32==t.radio?"index active":"index",on:{click:t.gotoIndex}},[t._v("首页")]),a("span",{class:33==t.radio?"advertisement active":"advertisement",on:{click:t.gotoAdver}},[t._v("广告收入明细")]),a("span",{class:41==t.radio?"advertisement active":"advertisement",on:{click:t.gotoMember}},[t._v("会员收入明细")]),a("span",{class:42==t.radio?"advertisement active":"advertisement",on:{click:t.gotoPackage}},[t._v("套餐复购情况")])]),a("div",[a("el-button",{staticClass:"margin-top",on:{click:function(e){t.dialogVisible=!0}}},[t._v("模块设置")])],1)]),a("el-dialog",{attrs:{title:t.DashboardSetting.basename,visible:t.dialogVisible,width:"30%"},on:{close:t.resumeDashboardSetting,"update:visible":function(e){t.dialogVisible=e}}},[a("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},t._l(t.DashboardSetting.children,(function(e,r){return a("el-checkbox",{key:r,attrs:{label:e.id}},[t._v(t._s(e.basename))])})),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.resumeDashboardSetting}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.saveBoardSetting}},[t._v("确 定")])],1)],1),32==t.radio?a("Index",{ref:"index",attrs:{checkList:t.changeCheckList}}):t._e(),33==t.radio?a("Advertisement",{ref:"index",attrs:{checkList:t.changeCheckList}}):t._e(),41==t.radio?a("MemberDetails",{ref:"index",attrs:{checkList:t.changeCheckList}}):t._e(),42==t.radio?a("PackageF",{ref:"index",attrs:{checkList:t.changeCheckList}}):t._e()],1)},i=[],o=a("2909"),n=(a("ac6a"),a("3835")),s=(a("96cf"),a("1da1")),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("FilterLayout",{attrs:{width:"100px",mdSpan:6,flexFlag:!0},on:{onSubmit:t.onSubmit},model:{value:t.searchForm,callback:function(e){t.searchForm=e},expression:"searchForm"}},[a("div",{staticClass:"component_title2"},[t._v("筛选项")]),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选部门",prop:"department_id"}},[a("SelectCustomize",{attrs:{value:t.departmentInfo,data:t.department_id},on:{changeScope:t.changeProjectTeam}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选项目组",prop:"group_id"}},[a("SelectCustomize",{attrs:{value:t.groupIdInfo,data:t.group_id},on:{changeScope:t.changeApp}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选项目",prop:"project"}},[a("SelectCustomize",{attrs:{value:t.projectInfo,data:t.article_id},on:{changeScope:t.changeArticle}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选应用",prop:"appid"}},[a("SelectCustomize",{attrs:{value:t.appidInfo,data:t.apps},on:{changeScope:t.changeAppid}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选系统",prop:"system"}},[a("SelectCustomize",{attrs:{value:t.systemInfo,data:t.systemIds},on:{changeScope:t.changeSystem}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"时间维度",prop:"timeType"}},[a("el-select",{attrs:{placeholder:"请选择","popper-append-to-body":!1},model:{value:t.searchForm.timeType,callback:function(e){t.$set(t.searchForm,"timeType",e)},expression:"searchForm.timeType"}},t._l(t.timeType,(function(t,e){return a("el-option",{key:e,attrs:{label:t.title,value:t.id}})})),1)],1)],1),a("el-col",{attrs:{md:6,lg:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选时间"}},[a("dataPicker",{attrs:{datevalue:t.searchForm.time},on:{"update:datevalue":function(e){return t.$set(t.searchForm,"time",e)}}})],1)],1),a("el-button",{attrs:{slot:"btn-option"},on:{click:t.initFrom},slot:"btn-option"},[t._v("重置筛选")])],1),this.checkList.indexOf(34)>=0?a("div",{staticClass:"dash_board"},[a("div",{staticClass:"component_title"},[t._v("指示看板")]),a("div",{staticClass:"dash_board_card"},t._l(t.frontDashBoardData,(function(e,r){return a("el-col",{key:r,attrs:{lg:4,md:24,sm:24}},[a("div",{staticClass:"box"},[a("div",{staticClass:"title"},[t._v(t._s(e.title))]),a("div",{staticClass:"money"},[t._v("\n            "+t._s(-1!==t.titleArr.indexOf(e.title)?e.value:"￥"+e.value+"元")+"\n          ")]),a("div",{staticClass:"per"},[a("div",[a("div",[t._v("环比")]),a("div",[t._v("差值")])]),a("div",{staticClass:"rig_font"},[a("div",{class:e.per.indexOf("-")>=0?"down":"0.00%"==e.per?"":"up"},[t._v("\n                "+t._s(e.per)+"\n                "),a("i",{class:e.per.indexOf("-")>=0?"el-icon-caret-bottom":"0.00%"==e.per?"a":"el-icon-caret-top"})]),a("div",{class:e.dif.indexOf("-")>=0?"down":"0.00"==e.dif||"0.00%"==e.dif||"0.0000"==e.dif?"a":"up"},[t._v("\n                "+t._s(-1!==["昨日毛利率","本年累计毛利率"].indexOf(e.title)?e.dif:e.dif+"元")+"\n                "),a("i",{class:e.per.indexOf("-")>=0?"el-icon-caret-bottom":"0.00%"==e.per?"a":"el-icon-caret-top"})])])])])])})),1),a("div",{staticClass:"dash_board_card"},t._l(t.behindDashBoardData,(function(e,r){return a("el-col",{key:r,attrs:{lg:4,md:24,sm:24}},[a("div",{staticClass:"box"},[a("div",{staticClass:"title"},[t._v(t._s(e.title))]),a("div",{staticClass:"money"},[t._v("\n            "+t._s(-1!==t.titleArr.indexOf(e.title)?e.value:"￥"+e.value+"元")+"\n          ")]),a("div",{staticClass:"per"},[a("div",[a("div",[t._v("环比")]),a("div",[t._v("差值")])]),a("div",{staticClass:"rig_font"},[a("div",{class:e.per.indexOf("-")>=0?"down":"0.00%"==e.per?"":"up"},[t._v("\n                "+t._s(e.per)+"\n                "),a("i",{class:e.per.indexOf("-")>=0?"el-icon-caret-bottom":"0.00%"==e.per?"":"el-icon-caret-top"})]),a("div",{class:e.dif.indexOf("-")>=0?"down":"0.00"==e.dif||"0.00%"==e.dif||"0.0000"==e.dif?"":"up"},[t._v("\n                "+t._s(-1!==["昨日毛利率","本年累计毛利率"].indexOf(e.title)?e.dif:e.dif+"元")+"\n                "),a("i",{class:e.per.indexOf("-")>=0?"el-icon-caret-bottom":"0.00%"==e.per?"":"el-icon-caret-top"})])])])])])})),1)]):t._e(),this.checkList.indexOf(35)>=0?a("FunnelEcharts",{attrs:{option:t.funnelOption,twoOption:t.TfunnelOption}}):t._e(),this.checkList.indexOf(36)>=0?a("CountLayout",{attrs:{option:t.countData.data,loading:t.countData.loading,countInfoArr:t.countData.totalInfo,type:"newMix"},scopedSlots:t._u([{key:"option",fn:function(){return[a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"指标",prop:"key"}},[a("el-select",{attrs:{placeholder:"请选择","popper-append-to-body":!1},on:{change:t.changeComparisonKey},model:{value:t.form.key,callback:function(e){t.$set(t.form,"key",e)},expression:"form.key"}},t._l(t.key,(function(e,r){return a("el-option",{key:r,attrs:{disabled:t.form.c_key===e.id,label:e.title,value:e.id}})})),1)],1)],1),a("el-col",{staticClass:"height_centent",attrs:{md:6,sm:12}},[a("el-radio-group",{model:{value:t.form.comparison_type,callback:function(e){t.$set(t.form,"comparison_type",e)},expression:"form.comparison_type"}},t._l(t.comparison_data,(function(e,r){return a("el-radio",{key:r,attrs:{label:e.value},nativeOn:{click:function(a){return a.preventDefault(),t.initKeyType(e.value)}}},[t._v(t._s(e.title))])})),1)],1),1==t.form.comparison_type?a("el-col",{attrs:{md:6,sm:12}},[a("el-select",{attrs:{placeholder:"请选择","popper-append-to-body":!1},on:{change:t.fetchCount},model:{value:t.form.c_key,callback:function(e){t.$set(t.form,"c_key",e)},expression:"form.c_key"}},t._l(t.compareKey,(function(t,e){return a("el-option",{key:e,attrs:{label:t.title,value:t.id}})})),1)],1):t._e(),2==t.form.comparison_type?a("el-col",{attrs:{md:12,sm:12}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"","popper-append-to-body":!1},on:{change:t.changeDepart},model:{value:t.form.c_type,callback:function(e){t.$set(t.form,"c_type",e)},expression:"form.c_type"}},t._l(t.departDatas,(function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})})),1),a("el-select",{attrs:{placeholder:"请选择",multiple:"","collapse-tags":"",filterable:"","popper-append-to-body":!1},on:{change:t.selectAll},model:{value:t.form.c_group,callback:function(e){t.$set(t.form,"c_group",e)},expression:"form.c_group"}},[a("el-option",{attrs:{label:"全选",value:"all"}}),t._l(t.infoDeparts,(function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id,disabled:e.flag}},[a("span",{staticClass:"iconfont",class:e.system?t.formatSystemIcon(e.system):""},[t._v(t._s(e.title))])])}))],2)],1):t._e(),3==t.form.comparison_type?a("el-col",{attrs:{md:12,sm:12}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions0,clearable:!1},on:{blur:t.changeTimeEnd},model:{value:t.timeBegin,callback:function(e){t.timeBegin=e},expression:"timeBegin"}}),a("span",{staticClass:"among"},[t._v("对比")]),a("el-date-picker",{attrs:{type:"daterange","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions0,clearable:!1},on:{blur:t.changeTimeBegin},model:{value:t.timeEnd,callback:function(e){t.timeEnd=e},expression:"timeEnd"}})],1):t._e()]},proxy:!0},{key:"extras",fn:function(){},proxy:!0}],null,!1,4173300941)},[a("div",{staticClass:"component_title2 mrg_btn",attrs:{slot:"title"},slot:"title"},[t._v("趋势对比")])]):t._e(),this.checkList.indexOf(37)>=0?a("TableLayout",{attrs:{column:t.changeColumn,data:t.tableData.data,total:t.tableData.total,loading:t.tableData.loading,currentPage:t.tableOpt.currentPage,params:t.outPamrms,leadOut:!0,alignStyle:"center",leadApi:"Business/report",defaultSort:t.sort},on:{pageChange:t.onPageChange,sizeChange:t.onSizeChange,sortChange:t.onSortChange}},[a("div",{staticClass:"component_title",attrs:{slot:"title"},slot:"title"},[t._v("数据报表")]),a("div",{staticClass:"Tab_box",attrs:{slot:"table-option"},slot:"table-option"},[a("div",{staticClass:"left_box"},[a("span",{staticClass:"font14"},[t._v("数据维度（多选）")]),a("el-select",{staticClass:"my-select",attrs:{placeholder:"全部渠道","popper-append-to-body":!1,"reserve-keyword":!0,filterable:"",multiple:"","collapse-tags":""},on:{change:t.changeTable},model:{value:t.group,callback:function(e){t.group=e},expression:"group"}},[a("div",{staticClass:"check-all"},[a("el-checkbox",{on:{input:t.changeDimensional},model:{value:t.all,callback:function(e){t.all=e},expression:"all"}},[t._v("全部勾选")])],1),t._l(t.dimensionalData,(function(e,r){return a("el-option",{key:r,attrs:{value:e.value,label:e.title,disabled:1==t.group.length&&t.group[0]==e.value}})}))],2),a("el-checkbox",{staticStyle:{"margin-left":"20px"},on:{input:t.changeTableList},model:{value:t.flexFlag,callback:function(e){t.flexFlag=e},expression:"flexFlag"}},[t._v("冻结维度项")])],1),a("TransferDialog",{attrs:{data1:this.paramDetailData.showField,data2:this.paramDetailData.hiddenField,postApi:"Business/paramDetail",postParams:t.customFieldParams,transferCard:"index"},on:{paramSave:t.paramSave,initData:t.initData}},[a("div",{staticClass:"table-tabs",attrs:{slot:"tabs"},slot:"tabs"},t._l(t.memberpayTypes,(function(e){return a("span",{key:e.id,staticClass:"items",class:t.memberpayTypesActive==e.id?"active":"",on:{click:function(a){return t.memberpayTypeClick(e.id)}}},[t._v("\n            "+t._s(e.label)+"\n          ")])})),0)])],1)]):t._e()],1)},c=[],p=(a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("6b54"),a("8e6e"),a("456d"),a("7f7f"),a("28a5"),a("55dd"),a("ade3")),u=a("c1df"),h=a.n(u),d=a("cff8"),m=a.n(d),f=a("8bb5"),b=a("2f62"),g=a("2b38"),_=a("bb8b"),v=a("64ce"),y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box",staticStyle:{"min-height":"400px",width:"100%"}},[a("el-row",{attrs:{type:"flex",justify:"space-between",gutter:30}},[a("el-col",{attrs:{xl:12,lg:24}},[a("div",{staticClass:"bgfff"},[t._v("广告转化漏斗")]),a("div",{staticStyle:{background:"#fff",height:"400px"},attrs:{id:"funnel"}})]),a("el-col",{attrs:{xl:12,lg:24}},[a("div",{staticClass:"bgfff"},[t._v("付费转化漏斗图")]),a("div",{staticStyle:{background:"#fff",height:"400px"},attrs:{id:"twoFunnel"}})])],1)],1)},x=[],D=a("313e"),k=a.n(D),F={props:{option:{type:Object,default:function(){return{}}},twoOption:{type:Object,default:function(){return{}}}},data:function(){return{chart:null,twoChatr:null}},mounted:function(){this.init()},methods:{init:function(){this.chart=k.a.init(document.getElementById("funnel")),this.twoChatr=k.a.init(document.getElementById("twoFunnel")),this.chart.showLoading(),this.twoChatr.showLoading()}},watch:{option:function(t){this.chart.setOption(t),t.loading?this.chart.showLoading():this.chart.hideLoading()},twoOption:function(t){this.twoChatr.setOption(t),t.loading?this.twoChatr.showLoading():this.twoChatr.hideLoading()}}},O=F,I=(a("d655"),a("2877")),w=Object(I["a"])(O,y,x,!1,null,"2290ecce",null),S=w.exports,C={data:function(){return{compareKey:[],key:[],keyNumArr:[7,8,17,18,22,24,26,28,30],systemIds:[{id:"1",title:"Android"},{id:"2",title:"ios"},{id:"3",title:"小程序"}],titleArr:["昨日毛利率","本年累计毛利率"],nameArr:["首日ROI","毛利率","新增活跃比","买量新增比","订单收入占比","广告收入占比","商店支出占比","信息流支出占比","百度支出占比","新增用户次留","活跃用户次留"],numberArr:["百度CPI","ARPU值","会员ARPU","广告ARPU","买量CPI","商店CPI","信息流CPI"],keyArr:["roi_day1","gross_margin_per","device_active_per","pay_acquisitions_new_per","order_income_per","ad_income_per","cpd_invest_per","fd_invest_per","bd_invest_per"],numKeyArr:["date","project","department_title","group_title","app_title","system_title","roi_day1","gross_margin_per","device_active_per","pay_acquisitions_new_per","order_income_per","ad_income_per","cpd_invest_per","fd_invest_per","bd_invest_per","arpu","user_arpu","ad_arpu","pay_acquisitions_cpi","cpd_cpi","fd_cpi","bd_cpi"],timeType:[{id:"1",title:"日"}],column:[{label:"时间",prop:"date"},{label:"项目",prop:"project"},{label:"部门",prop:"department_title"},{label:"项目组",prop:"group_title"},{label:"应用",prop:"app_title"},{label:"系统",prop:"system_title"},{label:"新增",prop:"device_new",sortable:"custom"},{label:"活跃",prop:"device_active",sortable:"custom"},{label:"启动",prop:"open_times",sortable:"custom"},{label:"买量",prop:"pay_acquisitions",sortable:"custom"},{label:"收入",prop:"income_all",sortable:"custom"},{label:"支出",prop:"invest_all"},{label:"毛利",prop:"gross_margin"},{label:"毛利率",prop:"gross_margin_per"},{label:"首日ROI",prop:"roi_day1"},{label:"ARPU值",prop:"arpu"},{label:"会员ARPU",prop:"user_arpu"},{label:"广告ARPU",prop:"ad_arpu"},{label:"买量CPI",prop:"pay_acquisitions_cpi"},{label:"商店CPI",prop:"cpd_cpi"},{label:"信息流CPI",prop:"fd_cpi"},{label:"百度CPI",prop:"bd_cpi"},{label:"人均启动频次",prop:"open_times_avg"},{label:"新增活跃比",prop:"device_active_per"},{label:"买量新增比",prop:"pay_acquisitions_new_per"},{label:"新增用户次留",prop:"device_new_keep"},{label:"活跃用户次留",prop:"device_active_keep"},{label:"订单收入",prop:"order_income",sortable:"custom"},{label:"订单收入占比",prop:"order_income_per"},{label:"广告收入",prop:"ad_income_all",sortable:"custom"},{label:"广告收入占比",prop:"ad_income_per"},{label:"商店支出",prop:"cost_app",sortable:"custom"},{label:"商店支出占比",prop:"cpd_invest_per"},{label:"信息流支出",prop:"cost_feed",sortable:"custom"},{label:"信息流支出占比",prop:"fd_invest_per"},{label:"百度支出",prop:"cost_baidu",sortable:"custom"},{label:"百度支出占比",prop:"bd_invest_per"}],dimensionalData:[{title:"日期",value:1e3},{title:"项目",value:1003},{title:"部门",value:1001},{title:"项目组",value:1002},{title:"应用",value:1004},{title:"系统",value:1005}],tableOpt:{currentPage:1,pageSize:10},comparison_data:[{title:"指标对比",value:1},{title:"维度对比",value:2},{title:"时间对比",value:3}],infoDeparts:[],DashboardSetting:{basename:"",children:[]},apps:[],sort:{prop:"",order:""},checked:"",pickerOptions:{shortcuts:[{text:"昨天",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-864e5),t.$emit("pick",[a,e])}},{text:"近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"近30天",onClick:function(t){var e=h()().subtract(1,"months").format("YYYY-MM-DD"),a=h()().format("YYYY-MM-DD");t.$emit("pick",[e,a])}},{text:"近60天",onClick:function(t){var e=h()().subtract(2,"months").format("YYYY-MM-DD"),a=h()().format("YYYY-MM-DD");t.$emit("pick",[e,a])}},{text:"近90天",onClick:function(t){var e=h()().subtract(3,"months").format("YYYY-MM-DD"),a=h()().format("YYYY-MM-DD");t.$emit("pick",[e,a])}},{text:"本月",onClick:function(t){var e=new Date,a=e.getFullYear(),r=e.getMonth()+1,i=new Date(a+"-"+r+"-01");t.$emit("pick",[i,e])}},{text:"上个月",onClick:function(t){var e=h()().subtract(1,"months").endOf("month"),a=e.format("YYYY-MM-DD"),r=e.format("YYYY-MM-01");t.$emit("pick",[r,a])}}],disabledDate:function(t){return t.getTime()>Date.now()-864e5}},pickerOptions0:{disabledDate:function(t){return t.getTime()>Date.now()-864e5}}}}},A=a("73a1");function Y(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=P(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){s=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(s)throw o}}}}function P(t,e){if(t){if("string"===typeof t)return j(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?j(t,e):void 0}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function L(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function E(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?L(Object(a),!0).forEach((function(e){Object(p["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var T={mixins:[C],props:{checkList:{type:Array,default:function(){return[]}}},components:{FilterLayout:g["a"],CountLayout:f["a"],FunnelEcharts:S,TableLayout:_["a"],TransferDialog:v["a"],SelectCustomize:A["a"]},data:function(){return{searchForm:{project:[],appid:[],system:[],timeType:"1",department_id:[],group_id:[],time:[h()().subtract(7,"d").format("YYYY-MM-DD"),h()().subtract(1,"d").format("YYYY-MM-DD")]},dashBoardData:[],frontDashBoardData:[],behindDashBoardData:[],form:{key:0,comparison_type:"",c_key:"",c_type:"",c_group:[]},department_id:[],targetName:"",group_id:[],countData:{data:{},totalInfo:[],loading:!1},funnelOption:{},TfunnelOption:{},changeCheckList:[],departmentInfo:{appInfo:[]},groupIdInfo:{appInfo:[]},projectInfo:{appInfo:[]},appidInfo:{appInfo:[]},systemInfo:{appInfo:[]},tableData:{data:[],total:0,currentPage:1,pageSize:10,loading:!1},group:[1e3],transferDialog:!1,timeBegin:[],timeEnd:[],paramDetailData:{showField:[],hiddenField:[]},customProps:{value:"id",label:"title",children:"node"},all:!1,flexFlag:!1,departmentAll:!1,grouptAll:!1,appidAll:!1,articleAll:!1,apps:[],article_id:[],sumList:[],avgList:[],memberpayTypes:[{label:"整体会员付费情况",id:1},{label:"新用户付费情况",id:2},{label:"老用户付费情况",id:3}],memberpayTypesActive:1,sort:{prop:"",order:""}}},computed:{customFieldParams:function(){return{cate:1,timeStart:this.searchForm["time"][0],timeEnd:this.searchForm["time"][1]}},changeColumn:function(){var t=this,e=[],a=[{label:"时间",prop:"date",value:1e3},{label:"项目",prop:"project",value:1003},{label:"部门",prop:"department_title",value:1001},{label:"项目组",prop:"group_title",value:1002},{label:"应用",prop:"app_title",value:1004},{label:"系统",prop:"system_title",value:1005}],r={},i={},n=!1;return this.group.length?this.group.forEach((function(r){a.forEach((function(a){a.value==r&&(t.flexFlag?a.fixed="left":a.fixed="",e.push(a)),a.value==r&&"date"==a.prop&&(t.flexFlag?e.push({label:"星期",prop:"week",fixed:"left"}):e.push({label:"星期",prop:"week"}),n=!0)}))})):e=[].concat(a),r[e[0].prop]="总计",i[e[0].prop]="均值",this.paramDetailData.showField.forEach((function(a){t.column.forEach((function(o){a.value==o.label&&(r[o.prop]=t.sumList[o.prop],i[o.prop]=t.avgList[o.prop],e.push({label:a.value,prop:o.prop,sortable:o.sortable}))}))})),this.tableData.data[0]&&"总计"!=this.tableData.data[0][e[0].prop]&&(this.tableData.data=[r,i].concat(Object(o["a"])(this.tableData.data))),this.tableData.data.forEach((function(t){"总计"!=t.date&&"均值"!=t.date&&n&&(t.week=h()(t.date).format("dddd"))})),e},outPamrms:function(){var t=this.searchForm,e=this.group,a=this.tableOpt;return E(E(E({},t),a),{},{group:e.sort((function(t,e){return t-e}))})}},methods:E(E({},Object(b["b"])(["getAdApp"])),{},{getDashboardSetting:function(){this.getAdApp(),this.getParamList(),this.getDashboard(),this.funnelEach(),this.getReport(),this.getParamDetail(),this.getRoleBtree(),this.fetchCount()},changeProjectTeam:function(t){var e=this;this.searchForm.department_id=t.appInfo,this.searchForm.group_id=[],this.searchForm.appid=[],this.searchForm.project=[],this.groupIdInfo.appInfo=[],this.projectInfo.appInfo=[],this.appidInfo.appInfo=[];var a=[],r=[],i=[];this.searchForm.department_id.forEach((function(t){e.department_id.forEach((function(e){t==e.id&&(a=[].concat(Object(o["a"])(e.node),Object(o["a"])(a)),e.node.forEach((function(t){i.push.apply(i,Object(o["a"])(t.node)),t.node.forEach((function(t){r.push.apply(r,Object(o["a"])(t.node))}))})))}))})),this.group_id=Object(o["a"])(a),this.article_id=[].concat(i),this.apps=r,t.appInfo.length||this.getRoleBtree()},changeApp:function(t){var e=this;this.searchForm.group_id=t.appInfo,this.searchForm.appid=[],this.searchForm.project=[],this.projectInfo.appInfo=[],this.appidInfo.appInfo=[];var a=[],r=[];this.searchForm.group_id.length?this.searchForm.group_id.forEach((function(t){e.department_id.forEach((function(e){e.node.forEach((function(e){t==e.id&&(r.push.apply(r,Object(o["a"])(e.node)),e.node.forEach((function(t){a.push.apply(a,Object(o["a"])(t.node))})))}))}))})):this.group_id.forEach((function(t){e.department_id.forEach((function(e){e.node.forEach((function(e){t.id==e.id&&(r.push.apply(r,Object(o["a"])(e.node)),e.node.forEach((function(t){a.push.apply(a,Object(o["a"])(t.node))})))}))}))})),this.apps=a,this.article_id=[].concat(r)},changeArticle:function(t){var e=this;this.searchForm.project=t.appInfo,this.searchForm.appid=[],this.appidInfo.appInfo=[];var a=[];this.searchForm.project.length?this.searchForm.project.forEach((function(t){e.department_id.forEach((function(e){e.node.forEach((function(e){e.node.forEach((function(e){t==e.id&&a.push.apply(a,Object(o["a"])(e.node))}))}))}))})):this.article_id.forEach((function(t){a.push.apply(a,Object(o["a"])(t.node))})),this.apps=a},changeAppid:function(t){this.searchForm.appid=t.appInfo},changeSystem:function(t){this.searchForm.system=t.appInfo},getParamList:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("Business/paramList",{cate:1});case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return");case 8:this.key=i;case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getRoleBtree:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,s,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("System/roleBtree",{loginId:m.a.get("user")["id"],loginToken:m.a.get("loginToken")});case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return");case 8:this.department_id=i.tree,i.list.forEach((function(t){"应用"==t.title&&t.node.forEach((function(t){"1"==t.system?t.title=t.title+"_Android":"2"==t.system?t.title=t.title+"_IOS":"3"==t.system&&(t.title=t.title+"_微信小程序")}))})),this.departDatas=[].concat(Object(o["a"])(i.list),[{id:1005,title:"系统",node:Object(o["a"])(this.systemIds)}]),s=[],i.tree.forEach((function(t){t.node.forEach((function(t){s.push(t)}))})),this.group_id=s,l=[],c=[],i.tree.forEach((function(t){t.node.forEach((function(t){c.push.apply(c,Object(o["a"])(t.node)),t.node.forEach((function(t){l.push.apply(l,Object(o["a"])(t.node))}))}))})),this.apps=l,this.article_id=c;case 19:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onSubmit:function(){this.tableOpt.currentPage=1,this.funnelEach(),this.getDashboard(),this.fetchCount(),this.getReport()},initFrom:function(){this.departmentInfo.appInfo=[],this.groupIdInfo.appInfo=[],this.projectInfo.appInfo=[],this.appidInfo.appInfo=[],this.systemInfo.appInfo=[],this.searchForm={appid:[],system:[],timeType:"1",department_id:[],group_id:[],time:[h()().subtract(7,"d").format("YYYY-MM-DD"),h()().subtract(1,"d").format("YYYY-MM-DD")]},this.getDashboardSetting()},getDashboard:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("Business/dashboard",E(E({},this.searchForm),{},{timeBegin:this.searchForm["time"][0],timeEnd:this.searchForm["time"][1]}));case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return");case 8:s=Object(o["a"])(i),s.forEach((function(t){t.dif=parseFloat(t.dif).toLocaleString()+"","昨日毛利率"===t.title&&"本年累计毛利率"===t.title||("昨日ARPU"==t.title||"本年ARPU均值"==t.title||"昨日买量CPI"==t.title||"本年买量CPI均值"==t.title?(1==t.value.split(".")[1].length&&(t.value=t.value+"000"),2==t.value.split(".")[1].length&&(t.value=t.value+"00"),3==t.value.split(".")[1].length&&(t.value=t.value+"0")):t.value=parseFloat(t.value).toLocaleString()+""),"昨日毛利率"==t.title&&(t.value=t.value+"%"),"本年累计毛利率"==t.title&&(t.value=t.value+"%")})),this.frontDashBoardData=s.slice(0,6),this.behindDashBoardData=s.slice(6,12);case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changeComparisonKey:function(t){var e=this,a=[];this.key.forEach((function(r){r.id!==t&&a.push(r),r.id==t&&(e.targetName=r.title)})),this.compareKey=a,this.fetchCount()},fetchCount:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,s,l,c,p,u,d,m,f,b,g,_,v,y,x,D,k,F=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return 3!=this.form.comparison_type&&(this.timeEnd=[],this.timeBegin=""),e=this.searchForm,a=this.form,r=this.timeBegin,i=this.timeEnd,this.countData.loading=!0,t.next=5,this.$http.post("Business/comparison",E(E(E({},e),a),{},{timeStart:e["time"][0],c_timeBegin:i[0]?h()(i[0]).format("YYYY-MM-DD"):"",c_timeEnd:i[1]?h()(i[1]).format("YYYY-MM-DD"):"",timeBegin:r[0]?h()(r[0]).format("YYYY-MM-DD"):"",timeEnd:r[1]?h()(r[1]).format("YYYY-MM-DD"):e["time"][1]}));case 5:if(s=t.sent,l=Object(n["a"])(s,2),c=l[0],p=l[1],this.countData.loading=!1,!c){t.next=13;break}return this.countData.data={legendData:[],xAxisData:[],data:[],yAxis:[]},t.abrupt("return");case 13:u=p.date,d=p.data,m=p.totalInfo,f=void 0===m?[]:m,f.forEach((function(t){-1!==F.nameArr.indexOf(t.name)&&(t.avg=(100*t.avg).toFixed(2)+"%",t.total=(100*t.total).toFixed(2)+"%",t.hasPercentSign=!0)})),this.countData.totalInfo=f,-1===this.keyNumArr.indexOf(this.form.key)&&-1===this.keyNumArr.indexOf(this.form.c_key)||d.forEach((function(t){t.data=t.data.map((function(t){return F.nameArr.indexOf(F.targetName)>-1?(100*t).toFixed(2):1*t}))})),b=[],1==this.form.comparison_type?(g=d.map((function(t,e){return 0!=e?E(E({},t),{},{yAxisIndex:1}):E({yAxisIndex:0},t)})),_=[],u.forEach((function(t){_.push(t.startDate)})),_=_.map((function(t){return h()(t).format("YYYY-MM-DD")})),this.countData.data={legendData:d,xAxisData:_,data:g,yAxis:[{type:"value",name:this.nameArr.indexOf(d[0].name)>=0?d[0].name+"%":d[0].name,max:this.nameArr.indexOf(d[0].name)>=0?null:Math.max.apply(Math,Object(o["a"])(d[0].data)),splitLine:{lineStyle:{type:"dashed"}}},{type:"value",name:this.nameArr.indexOf(d[1].name)>=0?d[1].name+"%":d[1].name,splitLine:{lineStyle:{type:"dashed"}},max:this.nameArr.indexOf(d[1].name)>=0?null:Math.max.apply(Math,Object(o["a"])(d[1].data)),min:0}],formatter:function(t){var e="".concat(t[0].axisValueLabel,"<br/>");return t.forEach((function(t){e+="".concat(t.marker).concat(t.seriesName,"：").concat(F.nameArr.indexOf(t.seriesName)>=0?parseFloat(t.value).toLocaleString()+"%":F.numberArr.indexOf(t.seriesName)>=0?t.value:parseFloat(t.value).toLocaleString(),"<br/>")})),e}}):2==this.form.comparison_type?(v=[],y="",u.forEach((function(t){v.push(t.startDate)})),this.key.forEach((function(t){F.form.key==t.id&&(y=t.title)})),b=[{type:"value",name:y,splitLine:{lineStyle:{type:"dashed"}}}],v=v.map((function(t){return h()(t).format("YYYY-MM-DD")})),this.countData.data={legendData:d,xAxisData:v,data:d,yAxis:b,formatter:function(t){var e="".concat(t[0].axisValueLabel,"<br/>");return t.forEach((function(t){e+="".concat(t.marker).concat(t.seriesName,"<br/>").concat(y,"：").concat(-1!==F.nameArr.indexOf(y)?parseFloat(t.value).toLocaleString()+"%":parseFloat(t.value).toLocaleString(),"<br/>")})),e}}):3==this.form.comparison_type?(x=[],D="",u.forEach((function(t){x.push("".concat(h()(t.startDate).format("YYYY-MM-DD"),"\n").concat(h()(t.endDate).format("YYYY-MM-DD")))})),d[0].name==d[1].name&&(d[1].name=d[1].name+" "),this.key.forEach((function(t){F.form.key==t.id&&(D=t.title)})),b=[{type:"value",name:D,splitLine:{lineStyle:{type:"dashed"}}}],this.countData.data={legendData:d,xAxisData:x,data:d,yAxis:b,formatter:function(t){var e="",a=t[0].axisValueLabel.split("\n");return t.forEach((function(t,r){e+="".concat(a[r],"<br/>").concat(0==r?"<span ball style='width:10px;height: 10px;border-radius: 50%;background:#ffc706;display: inline-block;margin-right:4px;'></span>":"<span ball style='width:10px;height: 10px;border-radius: 50%;background:#5291ec;display: inline-block;margin-right:4px;'></span>").concat(D,"：").concat(parseFloat(t.value).toLocaleString(),"<br/>")})),e+="变化值：".concat((t[0].value-t[1].value+"").indexOf("-")?"<span style='color: #ea5454'>".concat(parseFloat((t[0].value-t[1].value).toFixed(2)).toLocaleString(),"</span>"):"<span style='color: #17bf5e'>".concat(parseFloat((t[0].value-t[1].value).toFixed(2)).toLocaleString(),"</span>"),"<br/>"),e+="变化率：".concat(((t[0].value-t[1].value)/t[1].value+"").indexOf("-")?"<span style='color: #ea5454'>".concat(((t[0].value-t[1].value)/t[1].value*100).toFixed(2)+"%","</span>"):"<span style='color: #17bf5e'>".concat(((t[0].value-t[1].value)/t[1].value*100).toFixed(2)+"%","</span>")),e}}):(k=[],u.forEach((function(t){k.push(t.startDate)})),b=[{type:"value",name:this.nameArr.indexOf(d[0].name)>=0?d[0].name+"(%)":d[0].name,min:0,max:this.nameArr.indexOf(d[0].name)>=0?null:Math.max.apply(Math,Object(o["a"])(d[0].data)),splitLine:{lineStyle:{type:"dashed"}}}],k=k.map((function(t){return h()(t).format("YYYY-MM-DD")})),this.countData.data={legendData:d,xAxisData:k,data:d,yAxis:b,formatter:function(t){var e="".concat(t[0].axisValueLabel,"<br/>");return t.forEach((function(t){e+="".concat(t.marker).concat(t.seriesName,"：").concat(F.nameArr.indexOf(t.seriesName)>=0?parseFloat(t.value).toLocaleString()+"%":parseFloat(t.value).toLocaleString(),"<br/>")})),e}});case 19:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),funnelEach:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,o,s,l,c,p,u,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.funnelOption={loading:!0},this.TfunnelOption={loading:!0},e=this.searchForm,t.next=5,this.$http.post("Business/funnelDetail",E(E({},e),{},{timeStart:e["time"][0],timeEnd:e["time"][1]}));case 5:if(a=t.sent,r=Object(n["a"])(a,2),i=r[0],o=r[1],!i){t.next=11;break}return t.abrupt("return");case 11:s=o.advert.data,l=o.advert.other,c=o.order.data,p=o.order.other,u={tooltip:{trigger:"item",formatter:function(t){var e=t.dataIndex,a=t.name,r=t.value,i="".concat(a,"： ").concat(parseFloat(r).toLocaleString());switch(e){case 0:break;case 1:l[e].per.indexOf("-")>=0?i+="<br/>广告填充率：".concat(l[e].rate,'%<br/>环比：<span style="color:rgb(38, 191, 106)">').concat(l[e].per,"%</span>"):-1==l[e].rate.indexOf("-")&&"0.00%"!=l[e]?i+="<br/>广告填充率：".concat(l[e].rate,'%<br/>环比：<span style="color:rgb(246, 82, 82)">').concat(l[e].per,"%</span>"):i+="<br/>广告填充率：".concat(l[e].rate,"%<br/>环比：<span>").concat(l[e].per,"%</span>");break;case 2:l[e].per.indexOf("-")>=0?i+="<br/>曝光率：".concat(l[e].rate,'%<br/>环比：<span style="color:rgb(38, 191, 106)">').concat(l[e].per,"%</span>"):-1==l[e].rate.indexOf("-")&&"0.00%"!=l[e]?i+="<br/>曝光率：".concat(l[e].rate,'%<br/>环比：<span style="color:rgb(246, 82, 82)">').concat(l[e].per,"%</span>"):i+="<br/>曝光率：".concat(l[e].rate,"%<br/>环比：<span>").concat(l[e].per,"%</span>");break;case 3:l[e].per.indexOf("-")>=0?i+="<br/>点击率：".concat(l[e].rate,'%<br/>环比：<span style="color:rgb(38, 191, 106)">').concat(l[e].per,"%</span>"):-1==l[e].rate.indexOf("-")&&"0.00%"!=l[e]?i+="<br/>点击率：".concat(l[e].rate,'%<br/>环比：<span style="color:rgb(246, 82, 82)">').concat(l[e].per,"%</span>"):i+="<br/>点击率：".concat(l[e].rate,"%<br/>环比：<span>").concat(l[e].per,"%</span>");break}return i}},series:[{name:"广告流量",type:"funnel",left:"10%",top:60,bottom:60,width:"80%",minSize:"0%",maxSize:"100%",sort:"none",gap:2,label:{show:!0,position:"inside"},labelLine:{length:10,lineStyle:{width:1,type:"solid"}},itemStyle:{normal:{color:function(t){var e=["#2E96B4","#66D2DE","#FF9320","#DE4647"];return e[t.dataIndex]},borderColor:"#fff",borderWidth:1}},emphasis:{label:{fontSize:20}},data:s}],legend:{}},h={tooltip:{trigger:"item",formatter:function(t){var e=t.dataIndex,a=t.name,r=t.value,i="".concat(a,"： ").concat(parseFloat(r).toLocaleString());switch(e){case 0:break;case 1:p[e].per.indexOf("-")>=0?i+="<br/>注册率：".concat(p[e].rate,'%<br/>环比：<span style="color:rgb(38, 191, 106)">').concat(p[e].per,"%</span>"):-1==l[e].rate.indexOf("-")&&"0.00%"!=l[e]?i+="<br/>注册率：".concat(p[e].rate,'%<br/>环比：<span style="color:rgb(246, 82, 82)">').concat(p[e].per,"%</span>"):i+="<br/>注册率：".concat(p[e].rate,"%<br/>环比：").concat(p[e].per,"%");break;case 2:p[e].per.indexOf("-")>=0?i+="<br/>下单率：".concat(p[e].rate,'%<br/>环比：<span style="color:rgb(38, 191, 106)">').concat(p[e].per,"%</span>"):-1==l[e].rate.indexOf("-")&&"0.00%"!=l[e]?i+="<br/>下单率：".concat(p[e].rate,'%<br/>环比：<span style="color:rgb(246, 82, 82)">').concat(p[e].per,"%</span>"):i+="<br/>下单率：".concat(p[e].rate,"%<br/>环比：").concat(p[e].per,"%");break;case 3:p[e].per.indexOf("-")>=0?i+="<br/>支付成功率：".concat(p[e].rate,'%<br/>环比：<span style="color:rgb(38, 191, 106)">').concat(p[e].per,"%</span>"):-1==l[e].rate.indexOf("-")&&"0.00%"!=l[e]?i+="<br/>支付成功率：".concat(p[e].rate,'%<br/>环比：<span style="color:rgb(246, 82, 82)">').concat(p[e].per,"%</span>"):i+="<br/>支付成功率：".concat(p[e].rate,"%<br/>环比：").concat(p[e].per,"%");break}return i}},series:[{name:"付费转化",type:"funnel",left:"10%",top:60,bottom:60,width:"80%",minSize:"0%",maxSize:"100%",sort:"none",gap:2,label:{show:!0,position:"inside"},labelLine:{length:10,lineStyle:{width:1,type:"solid"}},itemStyle:{normal:{color:function(t){var e=["#2E96B4","#66D2DE","#FF9320","#DE4647"];return e[t.dataIndex]}},borderColor:"#fff",borderWidth:1},emphasis:{label:{fontSize:20}},data:c}],legend:{}},this.funnelOption=u,this.TfunnelOption=h;case 19:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onPageChange:function(t){this.tableOpt.currentPage=t,this.getReport()},onSizeChange:function(t){this.tableOpt.pageSize=t,this.getReport()},changeTable:function(t){this.getReport()},getReport:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,o,s,l,c,p,u,h,d,m,f,b,g=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.tableData.loading=!0,e=this.searchForm,a=this.group,r=this.tableOpt,i=this.sort,t.next=4,this.$http.post("Business/report",E(E(E(E({},e),r),i),{},{group:a.sort((function(t,e){return t-e})),timeStart:e["time"][0],timeEnd:e["time"][1]}));case 4:if(o=t.sent,s=Object(n["a"])(o,2),l=s[0],c=s[1],this.tableData.loading=!1,!l){t.next=12;break}return this.tableData={list:[],total:0,currentPage:1,pageSize:10,loading:!1},t.abrupt("return");case 12:for(f in p=c.list,u=c.currentPage,h=c.total,d=c.sumList,m=c.avgList,p.forEach((function(t){for(var e in t)g.keyArr.indexOf(e)>=0&&("roi_day1"===t[e]?t[e]=t[e]+"%":t[e]=(100*t[e]).toFixed(2)+"%"),-1===g.numKeyArr.indexOf(e)&&(t[e]=parseFloat(t[e]).toLocaleString()),"device_new_keep"!=e&&"device_active_keep"!=e||e&&(t[e]=(100*t[e]).toFixed(2)+"%")})),d)this.keyArr.indexOf(f)>=0&&("roi_day1"===d[f]?d[f]=d[f]+"%":d[f]=(100*d[f]).toFixed(2)+"%"),-1===this.numKeyArr.indexOf(f)&&(d[f]=parseFloat(d[f]).toLocaleString()),"device_new_keep"!=f&&"device_active_keep"!=f||f&&(d[f]=(100*d[f]).toFixed(2)+"%");for(b in m)this.keyArr.indexOf(b)>=0&&("roi_day1"===m[b]?m[b]=m[b]+"%":m[b]=(100*m[b]).toFixed(2)+"%"),-1===this.numKeyArr.indexOf(b)&&(m[b]=parseFloat(m[b]).toLocaleString()),"device_new_keep"!=b&&"device_active_keep"!=b||b&&(m[b]=(100*m[b]).toFixed(2)+"%");this.sumList=d,this.avgList=m,this.tableData.data=p,this.tableData.currentPage=u,this.tableData.total=h;case 21:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changeDepart:function(t){var e=this;this.infoDeparts=[],this.form.c_group=[],this.departDatas.forEach((function(a){a.id==t&&(e.infoDeparts=Object(o["a"])(a.node))}))},changeTimeEnd:function(){var t=this.timeBegin[0],e=this.timeBegin[1],a=h()(e).diff(h()(t),"days");a!=this.timeDiff&&(a>this.timeDiff?this.timeEnd=[h()(this.timeEnd[0]).subtract(a-this.timeDiff,"days").format("YYYY-MM-DD"),this.timeEnd[1]]:this.timeEnd=[h()(this.timeEnd[0]).add(this.timeDiff-a,"days").format("YYYY-MM-DD"),this.timeEnd[1]]),this.timeDiff=a,this.fetchCount()},changeTimeBegin:function(){var t=this.timeEnd[0],e=this.timeEnd[1],a=h()(e).diff(h()(t),"days");a!=this.timeDiff&&(a>this.timeDiff?this.timeBegin=[h()(this.timeBegin[0]).subtract(a-this.timeDiff,"days").format("YYYY-MM-DD"),this.timeBegin[1]]:this.timeBegin=[h()(this.timeBegin[0]).add(this.timeDiff-a,"days").format("YYYY-MM-DD"),this.timeBegin[1]]),this.timeDiff=a,this.fetchCount()},initKeyType:function(t){var e=this;switch(t===this.form.comparison_type?(this.form.comparison_type="",this.form={key:0,comparison_type:"",c_key:"",c_type:"",c_group:[]}):this.form.comparison_type=t,t){case 1:if(!this.form.comparison_type)return this.form.c_key="",void this.fetchCount();var a=[];this.key.forEach((function(t){t.id!==e.form.key&&a.push(t)})),this.compareKey=a,this.form.c_key=a[0].id,this.fetchCount();break;case 2:this.form.c_key="",this.form.c_type=1002,this.infoDeparts=Object(o["a"])(this.departDatas[0].node),this.form.c_group=[this.departDatas[0].node[0].id],this.fetchCount();break;case 3:this.form.c_key="";var r=this.searchForm["time"][0],i=this.searchForm["time"][1],n=h()(i).diff(h()(r),"days");this.timeBegin=this.searchForm.time;var s=h()(r).subtract(n+1,"days").format("YYYY-MM-DD"),l=h()(r).subtract(1,"days").format("YYYY-MM-DD");this.timeEnd=[s,l],this.timeDiff=n,this.fetchCount();break}},selectAll:function(t){var e,a=this,r=Y(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;"all"==i&&function(){var t=[];a.form.c_group=[],a.infoDeparts.forEach((function(e){t.push(e.id)})),a.form.c_group=[].concat(t)}()}}catch(o){r.e(o)}finally{r.f()}this.fetchCount()},getParamDetail:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("Business/paramDetail",{cate:1,timeStart:this.searchForm["time"][0],timeEnd:this.searchForm["time"][1]});case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return");case 8:i.showField.forEach((function(t){t.isSelect=!1})),i.hiddenField.forEach((function(t){t.isSelect=!1})),this.paramDetailData=i;case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),paramSave:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.tableData.loading=!0,t.next=3,this.$http.post("Business/paramSave",E({cate:1,timeStart:this.searchForm["time"][0],timeEnd:this.searchForm["time"][1]},e));case 3:if(a=t.sent,r=Object(n["a"])(a,2),i=r[0],r[1],!i){t.next=9;break}return t.abrupt("return");case 9:this.getReport(),this.getParamDetail();case 11:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),initData:function(t){this.getReport(),this.getParamDetail()},onSortChange:function(t){var e=t.prop,a=t.order;this.sort={prop:e,order:a},this.tableOpt.currentPage=1,this.getReport()},changeDimensional:function(t){this.group=t?[1e3,1001,1002,1003,1004,1005]:[1e3],this.getReport()},changeTableList:function(t){var e=this;this.group.forEach((function(t){e.changeColumn.forEach((function(a){a.value==t&&(e.flexFlag?a.fixed="left":a.fixed=""),1e3==t&&e.flexFlag&&"week"==a.prop&&(a.fixed="left")}))}))},formatSystemIcon:function(t){switch(String(t)){case"1":return"icon-anzhuo";case"2":return"icon-ios";case"3":return"icon-weixin";case"4":return"icon-baidu";case"5":return"icon-chrome";default:return""}},memberpayTypeClick:function(t){this.memberpayTypesActive!=t&&(this.memberpayTypesActive=t)}})},M=T,R=(a("caaa"),Object(I["a"])(M,l,c,!1,null,"348bee16",null)),$=R.exports,B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("FilterLayout",{attrs:{width:"100px"},on:{onSubmit:t.onSubmit},model:{value:t.searchForm,callback:function(e){t.searchForm=e},expression:"searchForm"}},[a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选项目",prop:"project"}},[a("SelectCustomize",{attrs:{value:t.projectInfo,data:t.article_id},on:{changeScope:t.changeArticle}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选应用",prop:"appid"}},[a("SelectCustomize",{attrs:{value:t.appidInfo,data:t.apps},on:{changeScope:t.getAdFiltrate}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"收入渠道",prop:"ad_platform"}},[a("SelectCustomize",{attrs:{value:t.adPlatformInfo,data:t.ad_platform},on:{changeScope:t.changeAdtypemine}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"广告类型",prop:"adtypemine_id"}},[a("SelectCustomize",{attrs:{value:t.adtypemineIdInfo,data:t.adtypemine_id},on:{changeScope:t.changeAdpositionid}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"广告位",prop:"adpositionid_id"}},[a("SelectCustomize",{attrs:{value:t.adpositionidInfo,data:t.adpositionid_id},on:{changeScope:t.changeADID}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"三方广告位id",prop:"placement_id_oth"}},[a("SelectCustomize",{attrs:{value:t.placementIdOthInfo,data:t.placement_id_oth},on:{changeScope:t.changePlacementIdOth}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"ADID",prop:"ad_id"}},[a("SelectCustomize",{attrs:{value:t.adIdInfo,data:t.ad_id},on:{changeScope:t.changeTtile}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"广告名称",prop:"title"}},[a("SelectCustomize",{attrs:{value:t.changeAppKeyOthInfo,data:t.title},on:{changeScope:t.changeApp_key_oth}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"三方媒体ID",prop:"app_key_oth"}},[a("SelectCustomize",{attrs:{value:t.appKeyOthInfo,data:t.app_key_oth},on:{changeScope:t.changeAppKeyOth}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选系统",prop:"system"}},[a("SelectCustomize",{attrs:{value:t.systemInfo,data:t.systemIds},on:{changeScope:t.changeSystem}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"时间维度",prop:"timeType"}},[a("el-select",{attrs:{placeholder:"请选择","popper-append-to-body":!1},model:{value:t.searchForm.timeType,callback:function(e){t.$set(t.searchForm,"timeType",e)},expression:"searchForm.timeType"}},t._l(t.timeType,(function(t,e){return a("el-option",{key:e,attrs:{label:t.title,value:t.id}})})),1)],1)],1),a("el-col",{attrs:{md:12,lg:6,sm:24}},[a("el-form-item",{attrs:{label:"筛选时间"}},[a("dataPicker",{attrs:{datevalue:t.searchForm.time},on:{"update:datevalue":function(e){return t.$set(t.searchForm,"time",e)}}})],1)],1),a("el-button",{attrs:{slot:"btn-option"},on:{click:t.initFrom},slot:"btn-option"},[t._v("重置筛选")])],1),this.checkList.indexOf(38)>=0?a("CountLayout",{attrs:{option:t.countData.data,loading:t.countData.loading,countInfoArr:t.countData.totalInfo,type:"newMix"},scopedSlots:t._u([{key:"option",fn:function(){return[a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"指标",prop:"key"}},[a("el-select",{attrs:{placeholder:"请选择","popper-append-to-body":!1},on:{change:t.changeComparisonKey},model:{value:t.form.key,callback:function(e){t.$set(t.form,"key",e)},expression:"form.key"}},t._l(t.key,(function(e,r){return a("el-option",{key:r,attrs:{disabled:t.form.c_key===e.id,label:e.title,value:e.id}})})),1)],1)],1),a("el-col",{staticClass:"height_centent",attrs:{md:6,sm:12}},[a("el-radio-group",{model:{value:t.form.comparison_type,callback:function(e){t.$set(t.form,"comparison_type",e)},expression:"form.comparison_type"}},t._l(t.comparison_data,(function(e,r){return a("el-radio",{key:r,attrs:{label:e.value},nativeOn:{click:function(a){return a.preventDefault(),t.initKeyType(e.value)}}},[t._v(t._s(e.title))])})),1)],1),1==t.form.comparison_type?a("el-col",{attrs:{md:6,sm:12}},[a("el-select",{attrs:{placeholder:"请选择","popper-append-to-body":!1},on:{change:t.fetchCount},model:{value:t.form.c_key,callback:function(e){t.$set(t.form,"c_key",e)},expression:"form.c_key"}},t._l(t.compareKey,(function(t,e){return a("el-option",{key:e,attrs:{label:t.title,value:t.id}})})),1)],1):t._e(),2==t.form.comparison_type?a("el-col",{attrs:{md:12,sm:12}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"","popper-append-to-body":!1},on:{change:t.changeDepart},model:{value:t.form.c_type,callback:function(e){t.$set(t.form,"c_type",e)},expression:"form.c_type"}},t._l(t.departDatas,(function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})})),1),a("el-select",{attrs:{placeholder:"请选择",multiple:"","collapse-tags":"",filterable:"","popper-append-to-body":!1},on:{change:t.selectAll},model:{value:t.form.c_group,callback:function(e){t.$set(t.form,"c_group",e)},expression:"form.c_group"}},[a("el-option",{attrs:{label:"全选",value:"all"}}),t._l(t.infoDeparts,(function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}},[a("span",{staticClass:"iconfont",class:e.system?t.formatSystemIcon(e.system):""},[t._v(t._s(e.title))])])}))],2)],1):t._e(),3==t.form.comparison_type?a("el-col",{attrs:{md:12,sm:12}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions0,clearable:!1},on:{blur:t.changeTimeEnd},model:{value:t.timeBegin,callback:function(e){t.timeBegin=e},expression:"timeBegin"}}),a("span",{staticClass:"among"},[t._v("对比")]),a("el-date-picker",{attrs:{type:"daterange","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":t.pickerOptions0,clearable:!1},on:{blur:t.changeTimeBegin},model:{value:t.timeEnd,callback:function(e){t.timeEnd=e},expression:"timeEnd"}})],1):t._e()]},proxy:!0},{key:"extras",fn:function(){},proxy:!0}],null,!1,345793564)},[a("div",{staticClass:"component_title mrg_btn",attrs:{slot:"title"},slot:"title"},[t._v("趋势对比")])]):t._e(),this.checkList.indexOf(39)>=0?a("TableLayout",{attrs:{column:t.changeColumn,data:t.tableData.data,total:t.tableData.total,loading:t.tableData.loading,currentPage:t.tableOpt.currentPage,params:t.outPamrms,alignStyle:"center",leadOut:!0,leadApi:"Business/report",defaultSort:t.sort},on:{pageChange:t.onPageChange,sizeChange:t.onSizeChange,sortChange:t.onSortChange}},[a("div",{staticClass:"component_title2",attrs:{slot:"title"},slot:"title"},[t._v("数据报表")]),a("div",{staticClass:"Tab_box",attrs:{slot:"table-option"},slot:"table-option"},[a("div",{staticClass:"left_box"},[a("span",{staticClass:"font14"},[t._v("数据维度（多选）")]),a("el-select",{staticClass:"my-select",attrs:{placeholder:"全部渠道","popper-append-to-body":!1,"reserve-keyword":!0,filterable:"",multiple:"","collapse-tags":""},on:{change:t.getReport},model:{value:t.group,callback:function(e){t.group=e},expression:"group"}},[a("div",{staticClass:"check-all"},[a("el-checkbox",{on:{input:t.changeDimensional},model:{value:t.all,callback:function(e){t.all=e},expression:"all"}},[t._v("全部勾选")])],1),t._l(t.dimensionalData,(function(e,r){return a("el-option",{key:r,attrs:{value:e.value,label:e.title,disabled:1==t.group.length&&t.group[0]==e.value}})}))],2),a("el-checkbox",{staticStyle:{"margin-left":"20px"},on:{input:t.changeTableList},model:{value:t.flexFlag,callback:function(e){t.flexFlag=e},expression:"flexFlag"}},[t._v("冻结维度项")])],1),a("TransferDialog",{attrs:{data1:this.paramDetailData.showField,data2:this.paramDetailData.hiddenField,postApi:"Business/paramDetail",postParams:t.customFieldParams,transferCard:"advertisement"},on:{paramSave:t.paramSave,initData:t.initData}})],1)]):t._e()],1)},z=[],N={data:function(){return{timeType:[{id:"1",title:"日"}],apps:[],keyNumArr:[32,49,35,37,38],systemIds:[{id:"1",title:"Android"},{id:"2",title:"ios"},{id:"3",title:"小程序"}],adtypemine_id:[],adpositionid_id:[],ad_platform:[],numberArr:["广告ARPU","CPC"],nameArr:["占总收入占比","占广告收入占比","CTR","填充率","展示率"],keyArr:["cost_rate","ad_ctr","ad_gft","ad_show_rate","all_cost_rate"],numKeyArr:["ad_arpu_two","app_key_oth","ad_title","ad_id","th_cate","bu_adpositionid_id","bu_adtypemine_id","date","placement_id_oth","department_title","project","group_title","app_title","system_title","cost_rate","ad_ctr","ad_gft","ad_show_rate","all_cost_rate","ad_cpc"],ad_id:[],title:[],app_key_oth:[],comparison_data:[{title:"指标对比",value:1},{title:"维度对比",value:2},{title:"时间对比",value:3}],dimensionalData:[{title:"日期",value:1e3},{title:"项目",value:1003},{title:"应用",value:1004},{title:"系统",value:1005},{title:"广告类型",value:1007},{title:"广告位",value:1008},{title:"收入渠道",value:1006},{title:"ADID",value:1009},{title:"广告名称",value:1010},{title:"三方媒体ID",value:1011},{title:"三方广告位id",value:1012}],column:[{label:"时间",prop:"date"},{label:"项目",prop:"project"},{label:"应用",prop:"app_title"},{label:"系统",prop:"system_title"},{label:"广告类型",prop:"bu_adtypemine_id"},{label:"广告位",prop:"bu_adpositionid_id"},{label:"收入渠道",prop:"th_cate"},{label:"ADID",prop:"ad_id"},{label:"广告名称",prop:"ad_title"},{label:"三方媒体id",prop:"app_key_oth"},{label:"三方广告位id",prop:"placement_id_oth"},{label:"广告收入",prop:"cost",sortable:"custom"},{label:"占总收入占比",prop:"all_cost_rate"},{label:"占广告收入占比",prop:"cost_rate"},{label:"广告ARPU",prop:"ad_arpu_two"},{label:"ECPM",prop:"ad_ecpm",sortable:"custom"},{label:"CTR",prop:"ad_ctr",sortable:"custom"},{label:"CPC",prop:"ad_cpc",sortable:"custom"},{label:"填充率",prop:"ad_gft",sortable:"custom"},{label:"展示率",prop:"ad_show_rate",sortable:"custom"},{label:"人均广告次数",prop:"ad_show_avg_active"},{label:"次均广告次数",prop:"ad_show_avg_start"},{label:"请求数（本地）",prop:"request",sortable:"custom"},{label:"下发数（本地）",prop:"return",sortable:"custom"},{label:"展示数（本地）",prop:"show",sortable:"custom"},{label:"点击数（本地）",prop:"click",sortable:"custom"},{label:"请求数（第三方）",prop:"request_th",sortable:"custom"},{label:"下发数（第三方）",prop:"return_th",sortable:"custom"},{label:"展示数（第三方）",prop:"show_th",sortable:"custom"},{label:"点击数（第三方）",prop:"click_th",sortable:"custom"},{label:"人均广告请求频次",prop:"man_ad_frequency"},{label:"次均广告请求频次",prop:"times_ad_frequency"},{label:"现位置人均请求频次",prop:"man_req_frequency"},{label:"现位置人均展示频次",prop:"man_show_frequency"}],DashboardSetting:{basename:"",children:[]},pictLoading:!1,sort:{prop:"",order:""},checked:"",pickerOptions:{shortcuts:[{text:"昨天",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-864e5),t.$emit("pick",[a,e])}},{text:"近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"近30天",onClick:function(t){var e=h()().subtract(1,"months").format("YYYY-MM-DD"),a=h()().format("YYYY-MM-DD");t.$emit("pick",[e,a])}},{text:"近60天",onClick:function(t){var e=h()().subtract(2,"months").format("YYYY-MM-DD"),a=h()().format("YYYY-MM-DD");t.$emit("pick",[e,a])}},{text:"近90天",onClick:function(t){var e=h()().subtract(3,"months").format("YYYY-MM-DD"),a=h()().format("YYYY-MM-DD");t.$emit("pick",[e,a])}},{text:"本月",onClick:function(t){var e=new Date,a=e.getFullYear(),r=e.getMonth()+1,i=new Date(a+"-"+r+"-01");t.$emit("pick",[i,e])}},{text:"上个月",onClick:function(t){var e=h()().subtract(1,"months").endOf("month"),a=e.format("YYYY-MM-DD"),r=e.format("YYYY-MM-01");t.$emit("pick",[r,a])}}],disabledDate:function(t){return t.getTime()>Date.now()-864e5}},pickerOptions0:{disabledDate:function(t){return t.getTime()>Date.now()-864e5}}}}};function K(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=q(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return n=t.done,t},e:function(t){s=!0,o=t},f:function(){try{n||null==a.return||a.return()}finally{if(s)throw o}}}}function q(t,e){if(t){if("string"===typeof t)return G(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?G(t,e):void 0}}function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function V(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function U(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?V(Object(a),!0).forEach((function(e){Object(p["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var J={mixins:[N],props:{checkList:{type:Array,default:function(){return[]}}},data:function(){return{searchForm:{project:[],appid:[],system:[],ad_platform:[],adtypemine_id:[],adpositionid_id:[],ad_id:[],title:[],placement_id_oth:[],app_key_oth:[],timeType:"1",time:[h()().subtract(7,"d").format("YYYY-MM-DD"),h()().subtract(1,"d").format("YYYY-MM-DD")]},targetName:"",departDatas:[],infoDeparts:[],changeCheckList:[],placement_id_oth:[],sumList:[],avgList:[],projectInfo:{appInfo:[]},appidInfo:{appInfo:[]},adtypemineIdInfo:{appInfo:[]},adPlatformInfo:{appInfo:[]},adpositionidInfo:{appInfo:[]},adIdInfo:{appInfo:[]},placementIdOthInfo:{appInfo:[]},changeAppKeyOthInfo:{appInfo:[]},appKeyOthInfo:{appInfo:[]},systemInfo:{appInfo:[]},form:{key:31,comparison_type:"",c_key:"",c_type:"",c_group:[]},countData:{data:{},totalInfo:[],loading:!1},compareKey:[],key:[],timeBegin:[],timeEnd:[],tableData:{data:[],total:0,currentPage:1,pageSize:10,loading:!1},tableOpt:{currentPage:1,pageSize:10},group:[1e3],paramDetailData:{showField:[],hiddenField:[]},department_id:[],article_id:[],plat_pictLoading:!1,adtypemine_pictLoading:!1,dpositionid_pictLoading:!1,ad_id_pictLoading:!1,title_pictLoading:!1,app_key_pictLoading:!1,all:!1,flexFlag:!1,appAll:!1,articleAll:!1,sort:{prop:"",order:""}}},components:{CountLayout:f["a"],TransferDialog:v["a"],TableLayout:_["a"],FilterLayout:g["a"],SelectCustomize:A["a"]},computed:{customFieldParams:function(){return{cate:2,timeStart:this.searchForm["time"][0],timeEnd:this.searchForm["time"][1]}},changeColumn:function(){var t=this,e=[],a=[{label:"时间",prop:"date",value:1e3},{label:"项目",prop:"project",value:1003},{label:"应用",prop:"app_title",value:1004},{label:"系统",prop:"system_title",value:1005},{label:"广告类型",prop:"bu_adtypemine_id",value:1007},{label:"广告位",prop:"bu_adpositionid_id",value:1008},{label:"收入渠道",prop:"th_cate",value:1006},{label:"ADID",prop:"ad_id",value:1009},{label:"广告名称",prop:"ad_title",value:1010},{label:"三方媒体id",prop:"app_key_oth",value:1011},{label:"三方广告位id",prop:"placement_id_oth",value:1012}],r={},i={},n=!1;return this.group.length?this.group.forEach((function(r){a.forEach((function(a){a.value==r&&(t.flexFlag?a.fixed="left":a.fixed="",e.push(a)),a.value==r&&"date"==a.prop&&(t.flexFlag?e.push({label:"星期",prop:"week",fixed:"left"}):e.push({label:"星期",prop:"week"}),n=!0)}))})):e=[].concat(a),r[e[0].prop]="总计",i[e[0].prop]="均值",this.paramDetailData.showField.forEach((function(a){t.column.forEach((function(o){a.value==o.label&&(r[o.prop]=t.sumList[o.prop],i[o.prop]=t.avgList[o.prop],e.push({label:a.value,prop:o.prop,sortable:o.sortable}))}))})),this.tableData.data[0]&&"总计"!=this.tableData.data[0][e[0].prop]&&(this.tableData.data=[r,i].concat(Object(o["a"])(this.tableData.data))),this.tableData.data.forEach((function(t){"总计"!=t.date&&"均值"!=t.date&&n&&(console.log(t.date),t.week=h()(t.date).format("dddd"))})),e},outPamrms:function(){var t=this.searchForm,e=this.group,a=this.tableOpt;return U(U(U({},t),a),{},{cate:2,group:e.sort((function(t,e){return t-e}))})}},methods:{changeArticle:function(t){var e=this;this.searchForm.project=t.appInfo,this.searchForm.appid=[],this.appidInfo.appInfo=[],this.adtypemineIdInfo.appInfo=[],this.adPlatformInfo.appInfo=[],this.adpositionidInfo.appInfo=[],this.adIdInfo.appInfo=[],this.placementIdOthInfo.appInfo=[],this.changeAppKeyOthInfo.appInfo=[],this.appKeyOthInfo.appInfo=[];var a=[];console.log(t),this.searchForm.project.length?this.searchForm.project.forEach((function(t){e.department_id.forEach((function(e){e.node.forEach((function(e){e.node.forEach((function(e){t==e.id&&a.push.apply(a,Object(o["a"])(e.node))}))}))}))})):this.article_id.forEach((function(t){e.department_id.forEach((function(e){e.node.forEach((function(e){e.node.forEach((function(e){t==e.id&&a.push.apply(a,Object(o["a"])(e.node))}))}))}))})),this.apps=a,this.getAdFiltrate(),t.appInfo.length||this.getRoleBtree()},getAdFiltrate:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i,s,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e&&(this.searchForm.appid=e.appInfo?e.appInfo:this.searchForm.appid),!e||0!=e.appInfo.length){t.next=3;break}return t.abrupt("return");case 3:return this.searchForm.ad_platform=[],this.searchForm.adtypemine_id=[],this.searchForm.adpositionid_id=[],this.searchForm.ad_id=[],this.searchForm.app_key_oth=[],this.searchForm.title=[],this.adtypemineIdInfo.appInfo=[],this.adPlatformInfo.appInfo=[],this.adpositionidInfo.appInfo=[],this.adIdInfo.appInfo=[],this.placementIdOthInfo.appInfo=[],this.changeAppKeyOthInfo.appInfo=[],this.appKeyOthInfo.appInfo=[],this.plat_pictLoading=!0,a=this.searchForm,t.next=20,this.$http.post("Business/adFiltrate",U(U({},a),{},{timeStart:a["time"][0],timeEnd:a["time"][1]}));case 20:if(r=t.sent,i=Object(n["a"])(r,2),s=i[0],l=i[1],!s){t.next=27;break}return this.plat_pictLoading=!1,t.abrupt("return");case 27:if(l.advert.list){t.next=36;break}return this.ad_platform=[],this.adtypemine_id=[],this.adpositionid_id=[],this.ad_id=[],this.app_key_oth=[],this.title=[],this.plat_pictLoading=!1,t.abrupt("return");case 36:this.ad_platform=l.advert.list[0].children,this.adtypemine_id=l.advert.list[1].children,this.adpositionid_id=l.advert.list[2].children,this.ad_id=l.advert.list[3].children,this.app_key_oth=l.advert.list[4].children,this.title=l.advert.list[5].children,this.placement_id_oth=l.advert.list[6].children,this.departDatas=[{id:1003,title:"项目",children:Object(o["a"])(this.article_id)},{id:1004,title:"应用",children:Object(o["a"])(this.apps)}].concat(Object(o["a"])(l.advert.list),[{id:1005,title:"系统",children:Object(o["a"])(this.systemIds)}]),this.plat_pictLoading=!1;case 45:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),onInputAppAll:function(t){if(t){var e=[];this.apps.forEach((function(t){e.push(t.id)})),this.searchForm.appid=e}else this.searchForm.appid=[];this.getAdFiltrate()},onInputArticleAll:function(){},getRoleBtree:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i,s,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("System/roleBtree",{loginId:m.a.get("user")["id"],loginToken:m.a.get("loginToken")});case 2:if(a=t.sent,r=Object(n["a"])(a,2),i=r[0],s=r[1],!i){t.next=8;break}return t.abrupt("return");case 8:l=[],c=[],this.department_id=s.tree,s.tree.forEach((function(t){t.node.forEach((function(t){c.push.apply(c,Object(o["a"])(t.node)),t.node.forEach((function(t){l.push.apply(l,Object(o["a"])(t.node))}))}))})),this.apps=l,this.article_id=c;case 14:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changeAdtypemine:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e||0!=e.appInfo.length){t.next=3;break}return this.searchForm.ad_platform=[],t.abrupt("return");case 3:return this.searchForm.ad_platform=e.appInfo,this.adtypemine_pictLoading=!0,this.dpositionid_pictLoading=!0,this.ad_id_pictLoading=!0,this.title_pictLoading=!0,this.app_key_pictLoading=!0,this.searchForm.adtypemine_id=[],this.searchForm.adpositionid_id=[],this.searchForm.ad_id=[],this.searchForm.app_key_oth=[],this.searchForm.title=[],this.searchForm.placement_id_oth=[],this.adtypemineIdInfo.appInfo=[],this.adpositionidInfo.appInfo=[],this.adIdInfo.appInfo=[],this.placementIdOthInfo.appInfo=[],this.changeAppKeyOthInfo.appInfo=[],this.appKeyOthInfo.appInfo=[],a=this.searchForm,t.next=24,this.$http.post("Business/adFiltrate",U(U({},a),{},{timeStart:a["time"][0],timeEnd:a["time"][1]}));case 24:if(r=t.sent,i=Object(n["a"])(r,2),o=i[0],s=i[1],!o){t.next=35;break}return this.adtypemine_pictLoading=!1,this.dpositionid_pictLoading=!1,this.ad_id_pictLoading=!1,this.title_pictLoading=!1,this.app_key_pictLoading=!1,t.abrupt("return");case 35:this.adtypemine_id=s.advert.list[1].children,this.adpositionid_id=s.advert.list[2].children,this.ad_id=s.advert.list[3].children,this.app_key_oth=s.advert.list[4].children,this.title=s.advert.list[5].children,this.placement_id_oth=s.advert.list[6].children,this.adtypemine_pictLoading=!1,this.dpositionid_pictLoading=!1,this.ad_id_pictLoading=!1,this.title_pictLoading=!1,this.app_key_pictLoading=!1;case 46:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changeAdpositionid:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e||0!=e.appInfo.length){t.next=3;break}return this.searchForm.adtypemine_id=[],t.abrupt("return");case 3:return this.searchForm.adtypemine_id=e.appInfo,this.dpositionid_pictLoading=!0,this.ad_id_pictLoading=!0,this.title_pictLoading=!0,this.app_key_pictLoading=!0,this.searchForm.adpositionid_id=[],this.searchForm.ad_id=[],this.searchForm.app_key_oth=[],this.searchForm.title=[],this.searchForm.placement_id_oth=[],this.adpositionidInfo.appInfo=[],this.adIdInfo.appInfo=[],this.placementIdOthInfo.appInfo=[],this.changeAppKeyOthInfo.appInfo=[],this.appKeyOthInfo.appInfo=[],a=this.searchForm,t.next=21,this.$http.post("Business/adFiltrate",U(U({},a),{},{timeStart:a["time"][0],timeEnd:a["time"][1]}));case 21:if(r=t.sent,i=Object(n["a"])(r,2),o=i[0],s=i[1],!o){t.next=31;break}return this.dpositionid_pictLoading=!1,this.ad_id_pictLoading=!1,this.title_pictLoading=!1,this.app_key_pictLoading=!1,t.abrupt("return");case 31:this.adpositionid_id=s.advert.list[2].children,this.ad_id=s.advert.list[3].children,this.app_key_oth=s.advert.list[4].children,this.title=s.advert.list[5].children,this.placement_id_oth=s.advert.list[6].children,this.dpositionid_pictLoading=!1,this.ad_id_pictLoading=!1,this.title_pictLoading=!1,this.app_key_pictLoading=!1;case 40:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changeADID:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e||0!=e.appInfo.length){t.next=3;break}return this.searchForm.adpositionid_id=[],t.abrupt("return");case 3:return this.searchForm.adpositionid_id=e.appInfo,this.ad_id_pictLoading=!0,this.title_pictLoading=!0,this.app_key_pictLoading=!0,this.searchForm.ad_id=[],this.searchForm.app_key_oth=[],this.searchForm.title=[],this.searchForm.placement_id_oth=[],this.adIdInfo.appInfo=[],this.placementIdOthInfo.appInfo=[],this.changeAppKeyOthInfo.appInfo=[],this.appKeyOthInfo.appInfo=[],a=this.searchForm,t.next=18,this.$http.post("Business/adFiltrate",U(U({},a),{},{timeStart:a["time"][0],timeEnd:a["time"][1]}));case 18:if(r=t.sent,i=Object(n["a"])(r,2),o=i[0],s=i[1],!o){t.next=27;break}return this.ad_id_pictLoading=!1,this.title_pictLoading=!1,this.app_key_pictLoading=!1,t.abrupt("return");case 27:this.ad_id=s.advert.list[3].children,this.app_key_oth=s.advert.list[4].children,this.title=s.advert.list[5].children,this.placement_id_oth=s.advert.list[6].children,this.ad_id_pictLoading=!1,this.title_pictLoading=!1,this.app_key_pictLoading=!1;case 34:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changeTtile:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e||0!=e.appInfo.length){t.next=3;break}return this.searchForm.ad_id=[],t.abrupt("return");case 3:return this.searchForm.ad_id=e.appInfo,this.title_pictLoading=!0,this.app_key_pictLoading=!0,this.searchForm.app_key_oth=[],this.searchForm.title=[],this.changeAppKeyOthInfo.appInfo=[],this.appKeyOthInfo.appInfo=[],a=this.searchForm,t.next=13,this.$http.post("Business/adFiltrate",U(U({},a),{},{timeStart:a["time"][0],timeEnd:a["time"][1]}));case 13:if(r=t.sent,i=Object(n["a"])(r,2),o=i[0],s=i[1],!o){t.next=21;break}return this.title_pictLoading=!1,this.app_key_pictLoading=!1,t.abrupt("return");case 21:this.app_key_oth=s.advert.list[4].children,this.title=s.advert.list[5].children,this.title_pictLoading=!1,this.app_key_pictLoading=!1;case 25:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changeApp_key_oth:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e||0!=e.appInfo.length){t.next=3;break}return this.searchForm.title=[],t.abrupt("return");case 3:return this.searchForm.title=e.appInfo,this.app_key_pictLoading=!0,this.searchForm.app_key_oth=[],this.appKeyOthInfo.appInfo=[],a=this.searchForm,t.next=10,this.$http.post("Business/adFiltrate",U(U({},a),{},{timeStart:a["time"][0],timeEnd:a["time"][1]}));case 10:if(r=t.sent,i=Object(n["a"])(r,2),o=i[0],s=i[1],!o){t.next=17;break}return this.app_key_pictLoading=!1,t.abrupt("return");case 17:this.app_key_oth=s.advert.list[4].children,this.app_key_pictLoading=!1;case 19:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changeAppKeyOth:function(t){this.searchForm.app_key_oth=t.appInfo},changePlacementIdOth:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e||0!=e.appInfo.length){t.next=3;break}return this.searchForm.placement_id_oth=[],t.abrupt("return");case 3:return this.searchForm.placement_id_oth=e.appInfo,this.ad_id_pictLoading=!0,this.title_pictLoading=!0,this.app_key_pictLoading=!0,this.searchForm.ad_id=[],this.searchForm.app_key_oth=[],this.searchForm.title=[],this.adIdInfo.appInfo=[],this.changeAppKeyOthInfo.appInfo=[],this.appKeyOthInfo.appInfo=[],a=this.searchForm,t.next=16,this.$http.post("Business/adFiltrate",U(U({},a),{},{timeStart:a["time"][0],timeEnd:a["time"][1]}));case 16:if(r=t.sent,i=Object(n["a"])(r,2),o=i[0],s=i[1],!o){t.next=25;break}return this.ad_id_pictLoading=!1,this.title_pictLoading=!1,this.app_key_pictLoading=!1,t.abrupt("return");case 25:this.ad_id=s.advert.list[3].children,this.app_key_oth=s.advert.list[4].children,this.title=s.advert.list[5].children,this.ad_id_pictLoading=!1,this.title_pictLoading=!1,this.app_key_pictLoading=!1;case 31:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getDashboardSetting:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.getParamList(),this.getReport(),this.fetchCount(),this.getRoleBtree(),this.getAdFiltrate([]),this.getParamDetail();case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changeSystem:function(t){this.searchForm.system=t.appInfo},getParamList:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("Business/paramList",{cate:2});case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return");case 8:this.key=i;case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onSubmit:function(){this.tableOpt.currentPage=1,this.fetchCount(),this.getReport()},initFrom:function(){this.searchForm={appid:[],system:[],ad_platform:[],adtypemine_id:[],adpositionid_id:[],ad_id:[],title:[],app_key_oth:[],timeType:"1",time:[h()().subtract(7,"d").format("YYYY-MM-DD"),h()().subtract(1,"d").format("YYYY-MM-DD")]},this.projectInfo.appInfo=[],this.appidInfo.appInfo=[],this.adtypemineIdInfo.appInfo=[],this.adPlatformInfo.appInfo=[],this.adpositionidInfo.appInfo=[],this.adIdInfo.appInfo=[],this.placementIdOthInfo.appInfo=[],this.changeAppKeyOthInfo.appInfo=[],this.appKeyOthInfo.appInfo=[],this.getDashboardSetting()},changeComparisonKey:function(t){var e=this,a=[];this.key.forEach((function(r){r.id!==t&&a.push(r),r.id==t&&(e.targetName=r.title)})),this.compareKey=a,this.fetchCount()},fetchCount:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,s,l,c,p,u,d,m,f,b,g,_,v,y,x,D,k,F,O=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.searchForm,a=this.form,r=this.timeBegin,i=this.timeEnd,this.countData.loading=!0,t.next=4,this.$http.post("Business/advertComparison",U(U(U({},e),a),{},{timeStart:e["time"][0],c_timeBegin:i[0]?h()(i[0]).format("YYYY-MM-DD"):"",c_timeEnd:i[1]?h()(i[1]).format("YYYY-MM-DD"):"",timeBegin:r[0]?h()(r[0]).format("YYYY-MM-DD"):"",timeEnd:r[1]?h()(r[1]).format("YYYY-MM-DD"):e["time"][1]}));case 4:if(s=t.sent,l=Object(n["a"])(s,2),c=l[0],p=l[1],this.countData.loading=!1,!c){t.next=12;break}return this.countData.data={legendData:[],xAxisData:[],data:[],yAxis:[]},t.abrupt("return");case 12:u=p.date,d=p.data,m=p.totalInfo,f=void 0===m?[]:m,f.forEach((function(t){-1!==O.nameArr.indexOf(t.name)&&(t.avg=(100*t.avg).toFixed(2)+"%",t.total=(100*t.total).toFixed(2)+"%",t.hasPercentSign=!0)})),this.countData.totalInfo=f,b=[],d.forEach((function(t){O.nameArr.indexOf(t.name)>=0&&(t.data=t.data.map((function(t){return(100*t).toFixed(2)})))})),1==this.form.comparison_type?(g=d.map((function(t,e){return 0!=e?U(U({},t),{},{yAxisIndex:1}):U({yAxisIndex:0},t)})),_=[],u.forEach((function(t){_.push(h()(t.startDate).format("YYYY-MM-DD"))})),this.countData.data={legendData:d,xAxisData:_,data:g,yAxis:[{type:"value",name:this.nameArr.indexOf(d[0].name)>=0?d[0].name+"%":d[0].name,max:this.nameArr.indexOf(d[0].name)>=0?null:Math.max.apply(Math,Object(o["a"])(d[0].data)),splitLine:{lineStyle:{type:"dashed"}}},{type:"value",name:this.nameArr.indexOf(d[1].name)>=0?d[1].name+"%":d[1].name,splitLine:{lineStyle:{type:"dashed"}},max:this.nameArr.indexOf(d[1].name)>=0?null:Math.max.apply(Math,Object(o["a"])(d[1].data)),min:0}],formatter:function(t){var e="".concat(t[0].axisValueLabel,"<br/>");return t.forEach((function(t){e+="".concat(t.marker).concat(t.seriesName,"：").concat(O.nameArr.indexOf(t.seriesName)>=0?parseFloat(t.value).toLocaleString()+"%":O.numberArr.indexOf(t.seriesName)>=0?t.value:parseFloat(t.value).toLocaleString(),"<br/>")})),e}}):2==this.form.comparison_type?(v=[],y="",u.forEach((function(t){v.push(h()(t.startDate).format("YYYY-MM-DD"))})),this.key.forEach((function(t){O.form.key==t.id&&(y=t.title)})),b=[{type:"value",name:y,splitLine:{lineStyle:{type:"dashed"}}}],this.countData.data={legendData:d,xAxisData:v,data:d,yAxis:b,formatter:function(t){var e="".concat(t[0].axisValueLabel,"<br/>");return t.forEach((function(t){e+="".concat(t.marker).concat(t.seriesName,"<br/>").concat(y,"：").concat(-1!==O.nameArr.indexOf(y)?parseFloat(t.value).toLocaleString()+"%":parseFloat(t.value).toLocaleString(),"<br/>")})),e}}):3==this.form.comparison_type?(x=[],D="",u.forEach((function(t){x.push("".concat(h()(t.startDate).format("YYYY-MM-DD"),"\n").concat(h()(t.endDate).format("YYYY-MM-DD")))})),this.key.forEach((function(t){O.form.key==t.id&&(D=t.title)})),b=[{type:"value",name:D,splitLine:{lineStyle:{type:"dashed"}}}],this.countData.data={legendData:d,xAxisData:x,data:d,yAxis:b,formatter:function(t){var e="",a=t[0].axisValueLabel.split("\n");return t.forEach((function(t,r){e+="".concat(a[r],"<br/>").concat(0==r?"<span ball style='width:10px;height: 10px;border-radius: 50%;background:#ffc706;display: inline-block;margin-right:4px;'></span>":"<span ball style='width:10px;height: 10px;border-radius: 50%;background:#5291ec;display: inline-block;margin-right:4px;'></span>").concat(D,"：").concat(parseFloat(t.value).toLocaleString(),"<br/>")})),e+="变化值：".concat((t[0].value-t[1].value+"").indexOf("-")?"<span style='color: #ea5454'>".concat(parseFloat((t[0].value-t[1].value).toFixed(2)).toLocaleString(),"</span>"):"<span style='color: #17bf5e'>".concat(parseFloat((t[0].value-t[1].value).toFixed(2)).toLocaleString(),"</span>"),"<br/>"),e+="变化率：".concat(((t[0].value-t[1].value)/t[1].value+"").indexOf("-")?"<span style='color: #ea5454'>".concat(((t[0].value-t[1].value)/t[1].value*100).toFixed(2)+"%","</span>"):"<span style='color: #17bf5e'>".concat(((t[0].value-t[1].value)/t[1].value*100).toFixed(2)+"%","</span>")),e}}):(k=[],F=d.map((function(t){return U({},t)})),u.forEach((function(t){k.push(h()(t.startDate).format("YYYY-MM-DD"))})),b=[{type:"value",name:this.nameArr.indexOf(d[0].name)>=0?d[0].name+"(%)":d[0].name,min:0,max:this.nameArr.indexOf(d[0].name)>=0?null:Math.max.apply(Math,Object(o["a"])(d[0].data)),splitLine:{lineStyle:{type:"dashed"}}}],this.countData.data={legendData:d,xAxisData:k,data:F,yAxis:b,formatter:function(t){var e="".concat(t[0].axisValueLabel,"<br/>");return t.forEach((function(t){e+="".concat(t.marker).concat(t.seriesName,"：").concat(O.nameArr.indexOf(t.seriesName)>=0?parseFloat(t.value).toLocaleString()+"%":parseFloat(t.value).toLocaleString(),"<br/>")})),e}});case 18:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),selectAll:function(t){var e,a=this,r=K(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;"all"==i&&function(){var t=[];a.form.c_group=[],a.infoDeparts.forEach((function(e){t.push(e.id)})),a.form.c_group=[].concat(t)}()}}catch(o){r.e(o)}finally{r.f()}this.fetchCount()},initKeyType:function(t){var e=this;switch(t===this.form.comparison_type?(this.form.comparison_type="",this.form={key:31,comparison_type:"",c_key:"",c_type:"",c_group:[]}):this.form.comparison_type=t,t){case 1:if(!this.form.comparison_type)return this.form.c_key="",void this.fetchCount();var a=[];this.key.forEach((function(t,r){t.id!==e.form.key&&a.push(t)})),this.compareKey=a,this.form.c_key=a[0].id,this.fetchCount();break;case 2:this.form.c_key="",this.form.c_type=this.departDatas[0].id,this.infoDeparts=Object(o["a"])(this.departDatas[0].children),this.form.c_group=[this.departDatas[0].children[0].id],this.fetchCount();break;case 3:this.form.c_key="";var r=this.searchForm["time"][0],i=this.searchForm["time"][1],n=h()(i).diff(h()(r),"days");this.timeBegin=this.searchForm.time;var s=h()(r).subtract(n+1,"days").format("YYYY-MM-DD"),l=h()(r).subtract(1,"days").format("YYYY-MM-DD");this.timeEnd=[s,l],this.timeDiff=n,this.fetchCount();break}},changeDepart:function(t){var e=this;this.infoDeparts=[],this.form.c_group=[],this.departDatas.forEach((function(a){a.id==t&&(e.infoDeparts=Object(o["a"])(a.children))}))},changeTimeEnd:function(){var t=this.timeBegin[0],e=this.timeBegin[1],a=h()(e).diff(h()(t),"days");a!=this.timeDiff&&(a>this.timeDiff?this.timeEnd=[h()(this.timeEnd[0]).subtract(a-this.timeDiff,"days").format("YYYY-MM-DD"),this.timeEnd[1]]:this.timeEnd=[h()(this.timeEnd[0]).add(this.timeDiff-a,"days").format("YYYY-MM-DD"),this.timeEnd[1]]),this.timeDiff=a,this.fetchCount()},changeTimeBegin:function(){var t=this.timeEnd[0],e=this.timeEnd[1],a=h()(e).diff(h()(t),"days");a!=this.timeDiff&&(a>this.timeDiff?this.timeBegin=[h()(this.timeBegin[0]).subtract(a-this.timeDiff,"days").format("YYYY-MM-DD"),this.timeBegin[1]]:this.timeBegin=[h()(this.timeBegin[0]).add(this.timeDiff-a,"days").format("YYYY-MM-DD"),this.timeBegin[1]]),this.timeDiff=a,this.fetchCount()},onPageChange:function(t){this.tableOpt.currentPage=t,this.getReport()},onSizeChange:function(t){this.tableOpt.pageSize=t,this.getReport()},getReport:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,o,s,l,c,p,u,h,d,m,f,b,g=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.tableData.loading=!0,e=this.searchForm,a=this.group,r=this.tableOpt,i=this.sort,t.next=4,this.$http.post("Business/report",U(U(U(U({},e),r),i),{},{group:a.sort((function(t,e){return t-e})),timeStart:e["time"][0],timeEnd:e["time"][1],cate:2}));case 4:if(o=t.sent,s=Object(n["a"])(o,2),l=s[0],c=s[1],this.tableData.loading=!1,!l){t.next=12;break}return this.tableData={list:[],total:0,currentPage:1,pageSize:10,loading:!1},t.abrupt("return");case 12:for(f in p=c.list,u=c.currentPage,h=c.total,d=c.sumList,m=c.avgList,p.forEach((function(t){for(var e in t)g.keyArr.indexOf(e)>=0&&(t[e]=(100*t[e]).toFixed(2)+"%"),-1===g.numKeyArr.indexOf(e)&&(t[e]=parseFloat(t[e]).toLocaleString())})),d)this.keyArr.indexOf(f)>=0&&(d[f]=(100*d[f]).toFixed(2)+"%"),-1===this.numKeyArr.indexOf(f)&&(d[f]=parseFloat(d[f]).toLocaleString());for(b in m)this.keyArr.indexOf(b)>=0&&(m[b]=(100*m[b]).toFixed(2)+"%"),-1===this.numKeyArr.indexOf(b)&&(m[b]=parseFloat(m[b]).toLocaleString());this.tableData.data=p,this.tableData.currentPage=u,this.tableData.total=h,this.sumList=d,this.avgList=m;case 21:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getParamDetail:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("Business/paramDetail",{cate:2,timeStart:this.searchForm["time"][0],timeEnd:this.searchForm["time"][1]});case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return");case 8:i.showField.forEach((function(t){t.isSelect=!1})),i.hiddenField.forEach((function(t){t.isSelect=!1})),this.paramDetailData=i;case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),paramSave:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("Business/paramSave",U({cate:2,timeStart:this.searchForm["time"][0],timeEnd:this.searchForm["time"][1]},e));case 2:if(a=t.sent,r=Object(n["a"])(a,2),i=r[0],r[1],!i){t.next=8;break}return t.abrupt("return");case 8:this.getReport(),this.getParamDetail();case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),initData:function(t){this.getReport(),this.getParamDetail()},onSortChange:function(t){var e=t.prop,a=t.order;this.sort={prop:e,order:a},this.tableOpt.currentPage=1,this.getReport()},changeDimensional:function(t){this.group=t?[1001,1e3,1004,1005,1007,1008,1006,1009,1010,1011,1012]:[1e3],this.getReport()},changeTableList:function(t){var e=this;this.group.forEach((function(t){e.column.forEach((function(a){a.value==t&&(e.flexFlag?a.fixed="left":a.fixed=""),1e3==t&&e.flexFlag&&"week"==a.prop&&(a.fixed="left")}))}))},formatSystemIcon:function(t){switch(String(t)){case"1":return"icon-anzhuo";case"2":return"icon-ios";case"3":return"icon-weixin";case"4":return"icon-baidu";case"5":return"icon-chrome";default:return""}}}},H=J,W=(a("6e09"),Object(I["a"])(H,B,z,!1,null,"7b151f62",null)),Q=W.exports,X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("FilterLayout",{attrs:{width:"100px",mdSpan:6,flexFlag:!0},on:{onSubmit:t.onSubmit},model:{value:t.searchForm,callback:function(e){t.searchForm=e},expression:"searchForm"}},[a("div",{staticClass:"component_title2"},[t._v("筛选项")]),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选部门",prop:"department_id"}},[a("SelectCustomize",{attrs:{value:t.departmentInfo,data:t.department_id},on:{changeScope:t.changeProjectTeam,clearData:t.getOrderFiltrate}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选项目组",prop:"group_id"}},[a("SelectCustomize",{attrs:{value:t.groupIdInfo,data:t.group_id},on:{changeScope:t.changeApp,clearData:t.getOrderFiltrate}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选项目",prop:"project"}},[a("SelectCustomize",{attrs:{value:t.projectInfo,data:t.article_id},on:{changeScope:t.changeArticle,clearData:t.getOrderFiltrate}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选应用",prop:"appid"}},[a("SelectCustomize",{attrs:{value:t.appidInfo,data:t.apps},on:{changeScope:t.changeAppid,clearData:t.getOrderFiltrate}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选系统",prop:"system"}},[a("SelectCustomize",{attrs:{value:t.systemInfo,data:t.systemIds},on:{changeScope:t.changeSystem}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"收入渠道",prop:"income"}},[a("SelectChannel",{attrs:{appId:t.searchForm.appid},on:{input:t.changeIncome},model:{value:t.searchForm.channel,callback:function(e){t.$set(t.searchForm,"channel",e)},expression:"searchForm.channel"}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"是否首单",prop:"income"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchForm.is_first,callback:function(e){t.$set(t.searchForm,"is_first",e)},expression:"searchForm.is_first"}},t._l(t.ifirstorderIds,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"支付方式",prop:"payment"}},[a("SelectCustomize",{attrs:{value:t.paymentInfo,data:t.paymentIds},on:{changeScope:t.changePayment,clearData:t.changePath}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"购买路径",prop:"form_path"}},[a("el-cascader",{attrs:{options:t.form_pathIds,props:{multiple:!0,value:"id",label:"title"},filterable:"","collapse-tags":"",disabled:t.form_pathFlag},on:{change:t.changeform_path},model:{value:t.form_pathInfo,callback:function(e){t.form_pathInfo=e},expression:"form_pathInfo"}}),t.form_pathFlag?a("el-tooltip",{staticClass:"dark_item",attrs:{effect:"dark",placement:"right-start"}},[a("div",{staticClass:"tooltip-content",attrs:{slot:"content"},domProps:{innerHTML:t._s("请选择单个应用解除禁用")},slot:"content"}),a("i",{staticClass:"el-icon-info"})]):t._e()],1)],1),a("el-col",{attrs:{md:6,lg:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选时间"}},[a("dataPicker",{attrs:{datevalue:t.searchForm.time},on:{"update:datevalue":function(e){return t.$set(t.searchForm,"time",e)}}})],1)],1),a("el-button",{attrs:{slot:"btn-option"},on:{click:t.initFrom},slot:"btn-option"},[t._v("重置筛选")])],1),t.checkList.indexOf(42)>=0?a("TableLayout",{attrs:{column:t.changeColumn1,data:t.tableData2.data,total:t.tableData2.total,loading:t.tableData2.loading,currentPage:t.tableOpt2.currentPage,params:t.outPamrms,paramsType:t.memberpayTypesActive,leadOut:!0,defaultSort:t.sort2,alignStyle:"center",leadoutList:!0,leadApi:"Business/orderPay"},on:{pageChange:t.onPageChange2,sizeChange:t.onSizeChange2,sortChange:t.onSortChange2}},[a("div",{staticClass:"component_title",attrs:{slot:"title"},slot:"title"},[t._v("\n      会员付费情况表\n      "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right-start"}},[a("div",{staticClass:"tooltip-content",attrs:{slot:"content"},domProps:{innerHTML:t._s(1==t.memberpayTypesActive?t.user_tooltiptext1:2==t.memberpayTypesActive?t.user_tooltiptext2:3==t.memberpayTypesActive?t.user_tooltiptext3:t.user_tooltiptext1)},slot:"content"}),a("i",{staticClass:"el-icon-info"})])],1),a("div",{staticClass:"Tab_box",attrs:{slot:"table-option"},slot:"table-option"},[a("div",{staticClass:"left_box"},[a("span",{staticClass:"font14"},[t._v("数据维度（多选）")]),a("el-select",{attrs:{placeholder:"全部渠道","popper-append-to-body":!1,"reserve-keyword":!0,filterable:"",multiple:"","collapse-tags":""},on:{change:t.changeTable},model:{value:t.group,callback:function(e){t.group=e},expression:"group"}},[a("div",{staticClass:"check-all"},[a("el-checkbox",{on:{input:t.changeDimensional},model:{value:t.all,callback:function(e){t.all=e},expression:"all"}},[t._v("全部勾选")])],1),t._l(t.dimensionalData,(function(e,r){return a("el-option",{key:r,attrs:{value:e.value,label:e.title,disabled:1==t.group.length&&t.group[0]==e.value}})}))],2),a("el-checkbox",{staticStyle:{"margin-left":"20px"},on:{input:t.memberchangeTableList},model:{value:t.memberflexFlag,callback:function(e){t.memberflexFlag=e},expression:"memberflexFlag"}},[t._v("冻结维度项\n        ")])],1),a("TransferDialog",{key:t.tabkey,ref:"transfer",attrs:{data1:t.paramDetailData.showField,data2:t.paramDetailData.hiddenField,transferCard:"huiyuan",postParams:t.customFieldParams,postApi:"Business/paramDetail",huiyuanType:t.memberpayTypesActive},on:{paramSave:t.paramSave,initData:t.initData,moveItem:t.moveItem}},[a("div",{staticClass:"table-tabs",attrs:{slot:"navtabs"},slot:"navtabs"},t._l(t.memberpayTypes,(function(e){return a("span",{key:e.id,staticClass:"items",class:t.memberpayTypesActiveTab==e.id?"active":"",on:{click:function(a){return t.memberpayTypeClickTabs(e.id)}}},[t._v("\n            "+t._s(e.label)+"\n          ")])})),0)])],1),a("div",{staticClass:"table-tabs",attrs:{slot:"tabs"},slot:"tabs"},t._l(t.memberpayTypes,(function(e){return a("span",{key:e.id,staticClass:"items",class:t.memberpayTypesActive==e.id?"active":"",on:{click:function(a){return t.memberpayTypeClick(e.id)}}},[t._v("\n        "+t._s(e.label)+"\n      ")])})),0)]):t._e(),t.checkList.indexOf(43)>=0?a("TableLayout",{attrs:{column:t.changeColumn,tableType:"multilLevelHeader",childColumn:t.childColumn,data:t.tableData.data,total:t.tableData.total,loading:t.tableData.loading,currentPage:t.tableOpt.currentPage,params:t.outPamrms,paramsType:t.orderpackageActive,leadOut:!0,alignStyle:"center",leadoutList:!0,leadApi:"Business/orderPlan",defaultSort:t.sort,childList:!0},on:{pageChange:t.onPageChange,sizeChange:t.onSizeChange,sortChange:t.onSortChange}},[a("div",{staticClass:"component_title",attrs:{slot:"title"},slot:"title"},[t._v("\n      订单套餐情况表\n      "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right-start"}},[a("div",{staticClass:"tooltip-content",attrs:{slot:"content"},domProps:{innerHTML:t._s(1==t.orderpackageActive?t.order_tooltiptext1:2==t.orderpackageActive?t.order_tooltiptext2:3==t.orderpackageActive?t.order_tooltiptext3:t.order_tooltiptext1)},slot:"content"}),a("i",{staticClass:"el-icon-info"})])],1),a("div",{staticClass:"Tab_box",attrs:{slot:"table-option"},slot:"table-option"},[a("div",{staticClass:"left_box"},[a("el-checkbox",{staticStyle:{"margin-left":"20px"},model:{value:t.orderflexFlag,callback:function(e){t.orderflexFlag=e},expression:"orderflexFlag"}},[t._v("冻结维度项")])],1)]),a("div",{staticClass:"table-tabs",attrs:{slot:"tabs"},slot:"tabs"},t._l(t.orderpackageTypes,(function(e){return a("span",{key:e.id,staticClass:"items",class:t.orderpackageActive==e.id?"active":"",on:{click:function(a){return t.orderpackageTypeClick(e.id)}}},[t._v("\n        "+t._s(e.label)+"\n      ")])})),0)]):t._e()],1)},Z=[],tt={data:function(){return{compareKey:[],key:[],keyNumArr:[],systemIds:[{id:"1",title:"Android"},{id:"2",title:"ios"},{id:"3",title:"小程序"}],titleArr:[],nameArr:[],numberArr:[],keyArr:["total_subscribe_money_rate","total_week_money_rate","total_month_money_rate","total_quarter_money_rate","total_year_money_rate","total_ever_money_rate","total_subscribe_uv_rate","total_week_uv_rate","total_month_uv_rate","total_quarter_uv_rate","total_year_uv_rate","total_ever_uv_rate","total_pay_subscribe_uv_rate","total_pay_week_uv_rate","total_pay_quarter_uv_rate","total_pay_month_uv_rate","total_pay_year_uv_rate","total_pay_ever_uv_rate","total_new_money_rate","total_old_money_rate","pay_rate","vip_page_rate","vip_order_rate","pay_success_rate","device_new_reg_rate","total_other_money_rate","total_other_uv_rate","total_pay_other_uv_rate"],numKeyArr:["total_money","total_subscribe_money","total_week_money","total_month_money","total_quarter_money","total_year_money","total_ever_money","total_uv","total_subscribe_uv","total_week_uv","total_quarter_uv","total_year_uv","total_ever_uv","total_pay_uv","total_pay_subscribe_uv","total_pay_week_uv","total_pay_month_uv","total_pay_quarter_uv","total_pay_year_uv","total_pay_ever_uv",,"total_new_money","total_old_money","unit_price","device_active","vip_page_uv"],timeType:[{id:"1",title:"日"}],column:[{label:"",width:240,fixed:!1,children:[{label:"日期",prop:"date"},{label:"星期",prop:"week"}]},{label:"成功支付订单金额占比",children:[{label:"订阅订单总金额占比",prop:"total_subscribe_money_rate",sortable:"custom",width:180},{label:"周卡总金额占比",prop:"total_week_money_rate",sortable:"custom",width:160},{label:"月卡总金额占比",prop:"total_month_money_rate",sortable:"custom",width:160},{label:"季卡总金额占比",prop:"total_quarter_money_rate",sortable:"custom",width:160},{label:"年卡总金额占比",prop:"total_year_money_rate",sortable:"custom",width:160},{label:"永久总金额占比",prop:"total_ever_money_rate",sortable:"custom",width:160},{label:"其他类总金额占比",prop:"total_other_money_rate",sortable:"custom",width:160},{label:"总充值金额",prop:"total_money",sortable:"custom",width:150},{label:"订阅订单总金额",prop:"total_subscribe_money",sortable:"custom",width:160},{label:"周卡总金额",prop:"total_week_money",sortable:"custom"},{label:"月卡总金额",prop:"total_month_money",sortable:"custom"},{label:"季卡总金额",prop:"total_quarter_money",sortable:"custom"},{label:"年卡总金额",prop:"total_year_money",sortable:"custom"},{label:"永久总金额",prop:"total_ever_money",sortable:"custom"},{label:"其他类总金额",prop:"total_other_money",sortable:"custom",width:160}]},{label:"整体下单占比",children:[{label:"订阅订单总下单占比",prop:"total_subscribe_uv_rate",sortable:"custom",width:180},{label:"周卡总下单占比",prop:"total_week_uv_rate",sortable:"custom",width:160},{label:"月卡总下单占比",prop:"total_month_uv_rate",sortable:"custom",width:160},{label:"季卡总下单占比",prop:"total_quarter_uv_rate",sortable:"custom",width:160},{label:"年卡总下单占比",prop:"total_year_uv_rate",sortable:"custom",width:160},{label:"永久总下单占比",prop:"total_ever_uv_rate",sortable:"custom",width:160},{label:"其他类总下单占比",prop:"total_other_uv_rate",sortable:"custom",width:160},{label:"会员总下单uv",prop:"total_uv",sortable:"custom",width:150},{label:"订阅订单总下单uv",prop:"total_subscribe_uv",sortable:"custom",width:160},{label:"周卡总下单uv",prop:"total_week_uv",sortable:"custom",width:150},{label:"月卡总下单uv",prop:"total_month_uv",sortable:"custom",width:150},{label:"季卡总下单uv",prop:"total_quarter_uv",sortable:"custom",width:150},{label:"年卡总下单uv",prop:"total_year_uv",sortable:"custom",width:150},{label:"永久总下单uv",prop:"total_ever_uv",sortable:"custom",width:150},{label:"其他类总下单uv",prop:"total_other_uv",sortable:"custom",width:150}]},{label:"整体支付成功订单占比",children:[{label:"订阅订单总支付成功占比",prop:"total_pay_subscribe_uv_rate",sortable:"custom",width:200},{label:"周卡总支付成功占比",prop:"total_pay_week_uv_rate",sortable:"custom",width:180},{label:"季卡总支付成功占比",prop:"total_pay_quarter_uv_rate",sortable:"custom",width:180},{label:"月卡总支付成功占比",prop:"total_pay_month_uv_rate",sortable:"custom",width:180},{label:"年卡总支付成功占比",prop:"total_pay_year_uv_rate",sortable:"custom",width:180},{label:"永久总支付成功占比",prop:"total_pay_ever_uv_rate",sortable:"custom",width:180},{label:"其他类总支付成功占比",prop:"total_pay_other_uv_rate",sortable:"custom",width:195},{label:"会员总支付成功uv",prop:"total_pay_uv",sortable:"custom",width:180},{label:"订阅订单总支付成功uv",prop:"total_pay_subscribe_uv",sortable:"custom",width:200},{label:"周卡总支付成功uv",prop:"total_pay_week_uv",sortable:"custom",width:180},{label:"月卡总支付成功uv",prop:"total_pay_month_uv",sortable:"custom",width:180},{label:"季卡总支付成功uv",prop:"total_pay_quarter_uv",sortable:"custom",width:180},{label:"年卡总支付成功uv",prop:"total_pay_year_uv",sortable:"custom",width:180},{label:"永久总支付成功uv",prop:"total_pay_ever_uv",sortable:"custom",width:180},{label:"其他类总支付成功uv",prop:"total_pay_other_uv",sortable:"custom",width:180}]}],column1:[{label:"应用",prop:"appid"},{label:"系统",prop:"system"},{label:"渠道",prop:"origin"},{label:"支付方式",prop:"pay_way"},{label:"订单路径",prop:"from_path"},{label:"总充值金额",prop:"total_money",sortable:"custom"},{label:"新用户充值金额",prop:"total_new_money",sortable:"custom"},{label:"老用户充值金额",prop:"total_old_money",sortable:"custom"},{label:"新用户充值金额占比",prop:"total_new_money_rate",sortable:"custom"},{label:"老用户充值金额占比",prop:"total_old_money_rate",sortable:"custom"},{label:"总arpu",prop:"arpu",sortable:"custom"},{label:"总付费率",prop:"pay_rate",sortable:"custom"},{label:"客单价",prop:"unit_price",sortable:"custom"},{label:"会员页到达率",prop:"vip_page_rate",sortable:"custom"},{label:"会员下单率",prop:"vip_order_rate",sortable:"custom"},{label:"支付成功率",prop:"pay_success_rate",sortable:"custom"},{label:"日活",prop:"device_active",sortable:"custom"},{label:"会员页uv",prop:"vip_page_uv",sortable:"custom"},{label:"下单uv",prop:"total_uv",sortable:"custom"},{label:"支付成功uv",prop:"total_pay_uv",sortable:"custom"}],column2:[{label:"应用",prop:"appid"},{label:"系统",prop:"system"},{label:"渠道",prop:"origin"},{label:"支付方式",prop:"pay_way"},{label:"订单路径",prop:"from_path"},{label:"新用户充值金额占比",prop:"total_new_money_rate",sortable:"custom"},{label:"新用户充值金额",prop:"total_new_money",sortable:"custom"},{label:"新用户arpu",prop:"arpu",sortable:"custom"},{label:"新用户付费率",prop:"pay_rate",sortable:"custom"},{label:"新用户会员价值",prop:"vip_value",sortable:"custom"},{label:"新用户客单价",prop:"unit_price",sortable:"custom"},{label:"激活注册率",prop:"device_new_reg_rate",sortable:"custom"},{label:"会员页到达率",prop:"vip_page_rate",sortable:"custom"},{label:"会员下单率",prop:"vip_order_rate",sortable:"custom"},{label:"支付成功率",prop:"pay_success_rate",sortable:"custom"},{label:"新增",prop:"device_new",sortable:"custom"},{label:"新用户会员页uv",prop:"vip_page_uv",sortable:"custom"},{label:"新用户下单uv",prop:"total_uv",sortable:"custom"},{label:"新用户支付成功uv",prop:"total_pay_uv",sortable:"custom"}],column3:[{label:"应用",prop:"appid"},{label:"系统",prop:"system"},{label:"渠道",prop:"origin"},{label:"支付方式",prop:"pay_way"},{label:"订单路径",prop:"from_path"},{label:"老用户充值金额占比",prop:"total_old_money_rate",sortable:"custom"},{label:"老用户充值金额",prop:"total_old_money",sortable:"custom"},{label:"老用户arpu",prop:"arpu",sortable:"custom"},{label:"老用户付费率",prop:"pay_rate",sortable:"custom"},{label:"老用户会员价值",prop:"vip_value",sortable:"custom"},{label:"老用户客单价",prop:"unit_price",sortable:"custom"},{label:"老用户会员页到达率",prop:"vip_page_rate",sortable:"custom"},{label:"老用户会员下单率",prop:"vip_order_rate",sortable:"custom"},{label:"老用户支付成功率",prop:"pay_success_rate",sortable:"custom"},{label:"老用户数",prop:"old_user_num",sortable:"custom"},{label:"老用户会员页uv",prop:"vip_page_uv",sortable:"custom"},{label:"老用户下单uv",prop:"total_uv",sortable:"custom"},{label:"老用户支付成功uv",prop:"total_pay_uv",sortable:"custom"}],dimensionalData:[{title:"日期",value:1e3},{title:"项目",value:1003},{title:"部门",value:1001},{title:"项目组",value:1002},{title:"应用",value:1004},{title:"系统",value:1005}],tableOpt:{currentPage:1,pageSize:10},comparison_data:[{title:"指标对比",value:1},{title:"维度对比",value:2},{title:"时间对比",value:3}],user_tooltiptext1:"总充值金额：总付费金额<br>新用户充值金额：新用户付费金额<br>老用户充值金额：老用户付费金额<br>新用户充值金额占比：新用户充值金额/总充值金额<br>老用户充值金额占比：老用户充值金额/总充值金额<br>总arpu：总充值金额/日活<br>总付费率：支付成功uv/日活<br>客单价：总充值金额/支付成功uv<br>会员页到达率：会员页uv/日活<br>会员下单率：下单uv/会员页uv<br>支付成功率：支付成功uv/下单uv",user_tooltiptext2:"新用户收入占比：新用户充值金额/总充值金额<br>新用户arpu：新用户充值金额/日活<br>新用户付费率：新用户支付成功uv/新增<br>新用户会员价值：新用户充值金额/新增<br>新用户客单价：新用户充值金额/新用户支付成功uv<br>激活注册率：注册用户数/新增<br>会员页到达率：新用户会员页uv/新增<br>会员下单率：新用户下单uv/新用户会员页uv<br>支付成功率：新用户支付成功uv/新用户下单uv",user_tooltiptext3:"老用户收入占比：老用户充值金额/总充值金额<br>老用户arpu：老用户充值金额/日活<br>老用户付费率：老用户支付成功uv/老用户数<br>老用户会员价值：老用户充值金额/老用户数<br>老用户客单价：老用户充值金额/老用户支付成功uv<br>老用户会员页到达率：老用户会员页uv/老用户数<br>老用户会员下单率：老用户下单uv/老用户会员页uv<br>老用户支付成功率：老用户支付成功uv/老用户下单uv",order_tooltiptext1:"订阅订单总金额占比：订阅订单总金额/总充值金额<br>周卡总金额占比：周卡总金额/总充值金额<br>月卡总金额占比：月卡总金额/总充值金额<br>季卡总金额占比：季卡总金额/总充值金额<br>年卡总金额占比：年卡总金额/总充值金额<br>永久总金额占比：永久总金额/总充值金额<br>订阅订单总下单占比：订阅订单总下单uv/会员总下单uv<br>周卡总下单占比：周卡总下单uv/会员总下单uv<br>月卡总下单占比：月卡总下单uv/会员总下单uv<br>季卡总下单占比：季卡总下单uv/会员总下单uv<br>年卡总下单占比：年卡总下单uv/会员总下单uv<br>永久总下单占比：永久下单uv/会员总下单uv<br>订阅订单总支付成功占比：订阅订单总支付成功uv/会员总支付成功uv<br>周卡总支付成功占比：周卡总支付成功uv/会员总支付成功uv<br>月卡总支付成功占比：月卡总支付成功uv/会员总支付成功uv<br>季卡总支付成功占比：季卡总支付成功uv/会员总支付成功uv<br>年卡总支付成功占比：年卡总支付成功uv/会员总支付成功uv<br>永久总支付成功占比：永久总支付成功uv/会员总支付成功uv",order_tooltiptext2:"新用户订阅订单总金额占比：新用户订阅订单总金额/新用户总充值金额<br>新用户周卡总金额占比：新用户周卡总金额/新用户总充值金额<br>新用户月卡总金额占比：新用户月卡总金额/新用户总充值金额<br>新用户季卡总金额占比：新用户季卡总金额/新用户总充值金额<br>新用户年卡总金额占比：新用户年卡总金额/新用户总充值金额<br>新用户永久总金额占比：新用户永久总金额/新用户总充值金额<br>新用户订阅订单总下单占比：新用户订阅订单总下单uv/新用户会员总下单uv<br>新用户周卡总下单占比：新用户周卡总下单uv/新用户会员总下单uv<br>新用户月卡总下单占比：新用户月卡总下单uv/新用户会员总下单uv<br>新用户季卡总下单占比：新用户季卡总下单uv/新用户会员总下单uv<br>新用户年卡总下单占比：新用户年卡总下单uv/新用户会员总下单uv<br>新用户永久总下单占比：新用户永久下单uv/新用户会员总下单uv<br>新用户订阅订单总支付成功占比：新用户订阅订单总支付成功uv/新用户会员总支付成功uv<br>新用户周卡总支付成功占比：新用户周卡总支付成功uv/新用户会员总支付成功uv<br>新用户月卡总支付成功占比：新用户月卡总支付成功uv/新用户会员总支付成功uv<br>新用户季卡总支付成功占比：新用户季卡总支付成功uv/新用户会员总支付成功uv<br>新用户年卡总支付成功占比：新用户年卡总支付成功uv/新用户会员总支付成功uv<br>新用户永久总支付成功占比：新用户永久总支付成功uv/新用户会员总支付成功uv",order_tooltiptext3:"老用户订阅订单总金额占比：老用户订阅订单总金额/老用户总充值金额<br>老用户周卡总金额占比：老用户周卡总金额/老用户总充值金额<br>老用户月卡总金额占比：老用户月卡总金额/老用户总充值金额<br>老用户季卡总金额占比：老用户季卡总金额/老用户总充值金额<br>老用户年卡总金额占比：老用户年卡总金额/老用户总充值金额<br>老用户永久总金额占比：老用户永久总金额/老用户总充值金额<br>老用户订阅订单总下单占比：老用户订阅订单总下单uv/老用户会员总下单uv<br>老用户周卡总下单占比：老用户周卡总下单uv/老用户会员总下单uv<br>老用户月卡总下单占比：老用户月卡总下单uv/老用户会员总下单uv<br>老用户季卡总下单占比：老用户季卡总下单uv/老用户会员总下单uv<br>老用户年卡总下单占比：老用户年卡总下单uv/老用户会员总下单uv<br>老用户永久总下单占比：老用户永久下单uv/老用户会员总下单uv<br>老用户订阅订单总支付成功占比：老用户订阅订单总支付成功uv/老用户会员总支付成功uv<br>老用户周卡总支付成功占比：老用户周卡总支付成功uv/老用户会员总支付成功uv<br>老用户月卡总支付成功占比：老用户月卡总支付成功uv/老用户会员总支付成功uv<br>老用户季卡总支付成功占比：老用户季卡总支付成功uv/老用户会员总支付成功uv<br>老用户年卡总支付成功占比：老用户年卡总支付成功uv/老用户会员总支付成功uv<br>老用户永久总支付成功占比：老用户永久总支付成功uv/老用户会员总支付成功uv",infoDeparts:[],DashboardSetting:{basename:"",children:[]},apps:[],sort:{prop:"",order:""},checked:"",pickerOptions:{shortcuts:[{text:"昨天",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-864e5),t.$emit("pick",[a,e])}},{text:"近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"近30天",onClick:function(t){var e=h()().subtract(1,"months").format("YYYY-MM-DD"),a=h()().format("YYYY-MM-DD");t.$emit("pick",[e,a])}},{text:"近60天",onClick:function(t){var e=h()().subtract(2,"months").format("YYYY-MM-DD"),a=h()().format("YYYY-MM-DD");t.$emit("pick",[e,a])}},{text:"近90天",onClick:function(t){var e=h()().subtract(3,"months").format("YYYY-MM-DD"),a=h()().format("YYYY-MM-DD");t.$emit("pick",[e,a])}},{text:"本月",onClick:function(t){var e=new Date,a=e.getFullYear(),r=e.getMonth()+1,i=new Date(a+"-"+r+"-01");t.$emit("pick",[i,e])}},{text:"上个月",onClick:function(t){var e=h()().subtract(1,"months").endOf("month"),a=e.format("YYYY-MM-DD"),r=e.format("YYYY-MM-01");t.$emit("pick",[r,a])}}],disabledDate:function(t){return t.getTime()>Date.now()-864e5}},pickerOptions0:{disabledDate:function(t){return t.getTime()>Date.now()-864e5}}}}},et=a("d9ce");function at(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function rt(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?at(Object(a),!0).forEach((function(e){Object(p["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):at(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var it={mixins:[tt],components:{FilterLayout:g["a"],SelectCustomize:A["a"],TableLayout:_["a"],TransferDialog:v["a"],SelectChannel:et["a"]},props:{checkList:{type:Array,default:function(){return[]}}},data:function(){return{tabkey:1,form_pathFlag:!1,form_pathIds:[],form_pathInfo:[],searchForm:{project:[],appid:[],system:[],department_id:[],group_id:[],is_first:"",origin:[],pay_way:[],from_path:[],time:[h()().subtract(7,"d").format("YYYY-MM-DD"),h()().subtract(1,"d").format("YYYY-MM-DD")]},tableData:{data:[],total:0,currentPage:1,pageSize:10,loading:!1},tableOpt:{currentPage:1},tableData2:{data:[{}],total:0,currentPage:1,pageSize:10,loading:!1},tableOpt2:{currentPage:1},memberpayTypesActive:1,memberpayTypesActiveTab:1,previousMemberpayTypesActiveTab:1,orderpackageActive:1,paramDetailData1:{},paramDetailData2:{},paramDetailData3:{},paramDetailDataList:{},orderpackageTypes:[{label:"整体订单占比情况",id:1},{label:"新用户订单占比情况",id:2},{label:"老用户订单占比情况",id:3}],memberpayTypes:[{label:"整体会员付费情况",id:1},{label:"新用户付费情况",id:2},{label:"老用户付费情况",id:3}],dimensionalData:[{title:"时间",value:1e3},{title:"应用",value:1004},{title:"系统",value:1005},{title:"渠道",value:1013},{title:"支付方式",value:1015},{title:"订单路径",value:1016}],group:[1e3],department_id:[],group_id:[],article_id:[],apps:[],changeCheckList:[],incomeIds:[],paymentIds:[],fromPathIds:[],all:!1,orderflexFlag:!1,memberflexFlag:!1,ifirstorderIds:[{value:"",label:"全部"},{value:"1",label:"是"},{value:"0",label:"否"}],paramDetailData:{showField:[],hiddenField:[]},incomevalue:"",departmentInfo:{appInfo:[]},groupIdInfo:{appInfo:[]},projectInfo:{appInfo:[]},appidInfo:{appInfo:[]},systemInfo:{appInfo:[]},incomeInfo:{appInfo:[]},paymentInfo:{appInfo:[]},fromPathInfo:{appInfo:[]},sort:{prop:"",order:""},sort2:{prop:"",order:""},sumList:[],avgList:[],sumList2:[],avgList2:[],transFlag:!0}},computed:{customFieldParams:function(){return{cate:4,timeStart:this.searchForm["time"][0],timeEnd:this.searchForm["time"][1],third_cate:this.memberpayTypesActiveTab,appId:void 0}},outPamrms:function(){var t=this.searchForm,e=this.group,a=this.tableOpt;return rt(rt(rt({},t),a),{},{group:e.sort((function(t,e){return t-e}))})},childColumn:function(){var t=[],e=JSON.parse(JSON.stringify(this.column));return 2==this.orderpackageActive?e.forEach((function(e){""!==e.label?e.children.map((function(e){return e.label="新用户"+e.label,t.push(e),e})):e.children.map((function(e){return e.label=e.label,t.push(e),e}))})):3==this.orderpackageActive?e.forEach((function(e){""!==e.label?e.children.map((function(e){return e.label="老用户"+e.label,t.push(e),e})):e.children.map((function(e){return e.label=e.label,t.push(e),e}))})):e.forEach((function(e){e.children.forEach((function(e){t.push(e)}))})),t},changeColumn:function(){var t=this,e={},a={},r=JSON.parse(JSON.stringify(this.column));return r.forEach((function(r){r.children.forEach((function(i){e[i.prop]=t.sumList[i.prop],a[i.prop]=t.avgList[i.prop],"date"!=i.prop&&"week"!=i.prop||(t.orderflexFlag?r.fixed="left":r.fixed=!1)}))})),e["date"]="总计",a["date"]="均值",console.log(this.tableData.data[0]),this.tableData.data[0]&&"总计"!=this.tableData.data[0]["date"]&&(this.tableData.data=[e,a].concat(Object(o["a"])(this.tableData.data))),2==this.orderpackageActive?(r.forEach((function(t){""!==t.label?t.children.map((function(t){return t.label="新用户"+t.label,t})):t.children.map((function(t){return t.label=""+t.label,t}))})),console.log(r),r):3==this.orderpackageActive?(r.forEach((function(t){""!==t.label?t.children.map((function(t){return t.label="老用户"+t.label,t})):t.children.map((function(t){return t.label=""+t.label,t}))})),console.log(r),r):r},changeColumn1:function(){var t,e=this;t=2==this.memberpayTypesActive?this.column2:3==this.memberpayTypesActive?this.column3:this.column1;var a=[],r=[{label:"时间",prop:"date",value:1e3},{label:"应用",prop:"appid",value:1004},{label:"系统",prop:"system",value:1005},{label:"渠道",prop:"origin",value:1013},{label:"支付方式",prop:"pay_way",value:1015},{label:"订单路径",prop:"from_path",value:1016}],i={},n={},s=!1;return this.group.length?this.group.forEach((function(t){r.forEach((function(r){r.value==t&&(e.memberflexFlag?r.fixed="left":r.fixed="",a.push(r)),r.value==t&&"date"==r.prop&&(e.memberflexFlag?a.push({label:"星期",prop:"week",fixed:"left"}):a.push({label:"星期",prop:"week"}),s=!0)}))})):a=[].concat(r),i[a[0].prop]="总计",n[a[0].prop]="均值",this.paramDetailDataList.showField.forEach((function(r){t.forEach((function(t){r.value==t.label&&(i[t.prop]=e.sumList2[t.prop],n[t.prop]=e.avgList2[t.prop],a.push({label:r.value,prop:t.prop,sortable:t.sortable}))}))})),this.tableData2.data[0]&&"总计"!=this.tableData2.data[0][a[0].prop]&&(this.tableData2.data=[i,n].concat(Object(o["a"])(this.tableData2.data))),this.tableData2.data.forEach((function(t){"总计"!=t.date&&"均值"!=t.date&&s&&(t.week=h()(t.date).format("dddd"))})),a}},mounted:function(){},methods:{getDashboardSetting:function(){this.getParamDetail(),this.getParamDetailForList(),this.getRoleBtree(),this.getOrderFiltrate(),this.getOrderPlan(),this.getOrderPay(),console.log(this.checkList,666)},getRoleBtree:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,s,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("System/roleBtree",{loginId:m.a.get("user")["id"],loginToken:m.a.get("loginToken")});case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return");case 8:this.department_id=i.tree,i.list.forEach((function(t){"应用"==t.title&&t.node.forEach((function(t){"1"==t.system?t.title=t.title+"_Android":"2"==t.system?t.title=t.title+"_IOS":"3"==t.system&&(t.title=t.title+"_微信小程序")}))})),this.departDatas=[].concat(Object(o["a"])(i.list),[{id:1005,title:"系统",node:Object(o["a"])(this.systemIds)}]),s=[],i.tree.forEach((function(t){t.node.forEach((function(t){s.push(t)}))})),this.group_id=s,l=[],c=[],i.tree.forEach((function(t){t.node.forEach((function(t){c.push.apply(c,Object(o["a"])(t.node)),t.node.forEach((function(t){l.push.apply(l,Object(o["a"])(t.node))}))}))})),this.apps=l,this.article_id=c;case 19:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),initFrom:function(){this.departmentInfo.appInfo=[],this.groupIdInfo.appInfo=[],this.projectInfo.appInfo=[],this.appidInfo.appInfo=[],this.systemInfo.appInfo=[],this.incomeInfo.appInfo=[],this.paymentInfo.appInfo=[],this.fromPathInfo.appInfo=[],this.searchForm={project:[],appid:[],system:[],department_id:[],group_id:[],is_first:"",origin:[],pay_way:[],from_path:[],time:[h()().subtract(7,"d").format("YYYY-MM-DD"),h()().subtract(1,"d").format("YYYY-MM-DD")]}},onSubmit:function(){this.tableOpt.currentPage=1,this.tableOpt2.currentPage=1,this.getOrderPlan(),this.getOrderPay()},changeProjectTeam:function(t){var e=this;this.searchForm.department_id=t.appInfo,this.searchForm.group_id=[],this.searchForm.appid=[],this.searchForm.project=[],this.searchForm.from_path=[],this.searchForm.pay_way=[],this.searchForm.origin=[],this.groupIdInfo.appInfo=[],this.projectInfo.appInfo=[],this.appidInfo.appInfo=[],this.incomeInfo.appInfo=[],this.paymentInfo.appInfo=[],this.fromPathInfo.appInfo=[];var a=[],r=[],i=[];this.searchForm.department_id.forEach((function(t){e.department_id.forEach((function(e){t==e.id&&(a=[].concat(Object(o["a"])(e.node),Object(o["a"])(a)),e.node.forEach((function(t){i.push.apply(i,Object(o["a"])(t.node)),t.node.forEach((function(t){r.push.apply(r,Object(o["a"])(t.node))}))})))}))})),this.group_id=Object(o["a"])(a),this.article_id=[].concat(i),this.apps=r,t.appInfo.length||this.getRoleBtree(),t&&0==t.appInfo.length?this.searchForm.department_id=[]:this.getOrderFiltrate()},changeApp:function(t){var e=this;this.searchForm.group_id=t.appInfo,this.searchForm.appid=[],this.searchForm.project=[],this.searchForm.from_path=[],this.searchForm.pay_way=[],this.searchForm.origin=[],this.projectInfo.appInfo=[],this.appidInfo.appInfo=[],this.incomeInfo.appInfo=[],this.paymentInfo.appInfo=[],this.fromPathInfo.appInfo=[];var a=[],r=[];this.searchForm.group_id.length?this.searchForm.group_id.forEach((function(t){e.department_id.forEach((function(e){e.node.forEach((function(e){t==e.id&&(r.push.apply(r,Object(o["a"])(e.node)),e.node.forEach((function(t){a.push.apply(a,Object(o["a"])(t.node))})))}))}))})):this.group_id.forEach((function(t){e.department_id.forEach((function(e){e.node.forEach((function(e){t.id==e.id&&(r.push.apply(r,Object(o["a"])(e.node)),e.node.forEach((function(t){a.push.apply(a,Object(o["a"])(t.node))})))}))}))})),this.apps=a,this.article_id=[].concat(r),t&&0==t.appInfo.length?this.searchForm.group_id=[]:this.getOrderFiltrate()},changeArticle:function(t){var e=this;this.searchForm.project=t.appInfo,this.searchForm.appid=[],this.searchForm.from_path=[],this.searchForm.pay_way=[],this.searchForm.origin=[],this.appidInfo.appInfo=[],this.incomeInfo.appInfo=[],this.paymentInfo.appInfo=[],this.fromPathInfo.appInfo=[];var a=[];this.searchForm.project.length?this.searchForm.project.forEach((function(t){e.department_id.forEach((function(e){e.node.forEach((function(e){e.node.forEach((function(e){t==e.id&&a.push.apply(a,Object(o["a"])(e.node))}))}))}))})):this.article_id.forEach((function(t){a.push.apply(a,Object(o["a"])(t.node))})),this.apps=a,t&&0==t.appInfo.length?this.searchForm.project=[]:this.getOrderFiltrate()},changeAppid:function(t){this.searchForm.from_path=[],this.searchForm.pay_way=[],this.searchForm.origin=[],this.incomeInfo.appInfo=[],this.paymentInfo.appInfo=[],this.fromPathInfo.appInfo=[],this.searchForm.channel=[],this.searchForm.appid=t.appInfo,1==t.appInfo.length?this.form_pathFlag=!1:(this.searchForm.from_path_one=[],this.searchForm.from_path_two=[],this.searchForm.from_path_three=[],this.form_pathFlag=!0),t&&0==t.appInfo.length?this.searchForm.appid=[]:this.getOrderFiltrate()},changeSystem:function(t){this.searchForm.system=t.appInfo},changeform_path:function(t){if(0==t.length)this.searchForm.from_path_one=[],this.searchForm.from_path_two=[],this.searchForm.from_path_three=[];else{var e=[[],[],[]];t.forEach((function(t){t.forEach((function(t,a){e[a].push(t)}))})),console.log(e),this.searchForm.from_path_one=e[0],this.searchForm.from_path_two=e[1],this.searchForm.from_path_three=e[2]}},getOrderFiltrate:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("Business/orderFiltrate",rt(rt({},this.searchForm),{},{timeStart:this.searchForm.time[0],timeEnd:this.searchForm.time[1],appId:void 0}));case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return");case 8:i.forEach((function(t){1013==t.id?s.incomeIds=Object(o["a"])(t.children):1015==t.id?s.paymentIds=Object(o["a"])(t.children):1016==t.id&&(s.form_pathIds=Object(o["a"])(t.children))}));case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onPageChange:function(t){this.tableOpt.currentPage=t,this.getOrderPlan()},onSizeChange:function(t){this.tableOpt.pageSize=t,this.getOrderPlan()},onSortChange:function(t){var e=t.prop,a=t.order;this.sort={prop:e,order:a},this.tableOpt.currentPage=1,this.getOrderPlan()},onPageChange2:function(t){this.tableOpt2.currentPage=t,this.getOrderPay()},onSizeChange2:function(t){this.tableOpt2.pageSize=t,this.getOrderPay()},onSortChange2:function(t){console.log(t);var e=t.prop,a=t.order;this.sort2={prop:e,order:a},this.tableOpt2.currentPage=1,this.getOrderPay()},changeIncome:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i,s,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.searchForm.origin=e,this.searchForm.from_path=[],this.searchForm.pay_way=[],this.paymentInfo.appInfo=[],this.fromPathInfo.appInfo=[],!e||0!=e.length){t.next=8;break}return this.searchForm.origin=[],t.abrupt("return");case 8:return t.next=10,this.$http.post("Business/orderFiltrate",rt(rt({},this.searchForm),{},{timeStart:this.searchForm.time[0],timeEnd:this.searchForm.time[1],appId:void 0}));case 10:if(a=t.sent,r=Object(n["a"])(a,2),i=r[0],s=r[1],!i){t.next=16;break}return t.abrupt("return");case 16:s.forEach((function(t){1015==t.id?l.paymentIds=Object(o["a"])(t.children):1016==t.id&&(l.fromPathIds=Object(o["a"])(t.children))}));case 17:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changePay:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i,s,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.searchForm.origin=[],this.searchForm.from_path=[],this.searchForm.pay_way=[],this.paymentInfo.appInfo=[],this.fromPathInfo.appInfo=[],t.next=7,this.$http.post("Business/orderFiltrate",rt(rt({},this.searchForm),{},{timeStart:this.searchForm.time[0],timeEnd:this.searchForm.time[1],appId:void 0}));case 7:if(a=t.sent,r=Object(n["a"])(a,2),i=r[0],s=r[1],!i){t.next=13;break}return t.abrupt("return");case 13:s.forEach((function(t){1015==t.id?l.paymentIds=Object(o["a"])(t.children):1016==t.id&&(l.fromPathIds=Object(o["a"])(t.children))}));case 14:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changePayment:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i,s,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.searchForm.pay_way=e.appInfo,this.searchForm.from_path=[],this.fromPathInfo.appInfo=[],!e||0!=e.appInfo.length){t.next=6;break}return this.searchForm.pay_way=[],t.abrupt("return");case 6:return t.next=8,this.$http.post("Business/orderFiltrate",rt(rt({},this.searchForm),{},{timeStart:this.searchForm.time[0],timeEnd:this.searchForm.time[1],appId:void 0}));case 8:if(a=t.sent,r=Object(n["a"])(a,2),i=r[0],s=r[1],!i){t.next=14;break}return t.abrupt("return");case 14:s.forEach((function(t){1016==t.id&&(l.fromPathIds=Object(o["a"])(t.children))}));case 15:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changePath:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r,i,s,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.searchForm.pay_way=[],this.searchForm.from_path=[],this.fromPathInfo.appInfo=[],t.next=5,this.$http.post("Business/orderFiltrate",rt(rt({},this.searchForm),{},{timeStart:this.searchForm.time[0],timeEnd:this.searchForm.time[1],appId:void 0}));case 5:if(a=t.sent,r=Object(n["a"])(a,2),i=r[0],s=r[1],!i){t.next=11;break}return t.abrupt("return");case 11:s.forEach((function(t){1016==t.id&&(l.fromPathIds=Object(o["a"])(t.children))}));case 12:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),changeFromPath:function(t){this.searchForm.from_path=t.appInfo,t&&0==t.appInfo.length&&(this.searchForm.from_path=[])},getOrderPlan:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,o,s,l,c,p,u,d,m,f,b,g,_=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.tableData.loading=!0,e=this.searchForm,this.group,a=this.tableOpt,r=this.sort,t.next=4,this.$http.post("Business/orderPlan",rt(rt(rt(rt({},e),a),r),{},{type:this.orderpackageActive,timeStart:e.time[0],timeEnd:e.time[1],appId:void 0}));case 4:if(i=t.sent,o=Object(n["a"])(i,2),s=o[0],l=o[1],!s){t.next=11;break}return this.tableData.loading=!1,t.abrupt("return");case 11:for(b in this.tableData.loading=!1,c=l.list,p=l.avg_list,u=l.sum_list,d=l.currentPage,m=l.total,f=c.map((function(t){return t.week=h()(t.date).format("dddd"),t})),c.forEach((function(t){for(var e in t)_.keyArr.indexOf(e)>=0&&t[e]&&(t[e]=(100*t[e]).toFixed(2)+"%"),_.numKeyArr.indexOf(e)>=0&&t[e]&&(t[e]=parseFloat(t[e]).toLocaleString())})),u)this.keyArr.indexOf(b)>=0&&u[b]&&(u[b]=(100*u[b]).toFixed(2)+"%"),this.numKeyArr.indexOf(b)>=0&&u[b]&&(u[b]=parseFloat(u[b]).toLocaleString());for(g in p)this.keyArr.indexOf(g)>=0&&p[g]&&(p[g]=(100*p[g]).toFixed(2)+"%"),this.numKeyArr.indexOf(g)>=0&&p[g]&&(p[g]=parseFloat(p[g]).toLocaleString());this.tableData.data=f,this.tableData.currentPage=d,this.tableData.total=m,this.sumList=u,this.avgList=p;case 22:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getOrderPay:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,o,s,l,c,p,u,h,d,m,f,b,g=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.tableData2.loading=!0,e=this.searchForm,a=this.group,r=this.tableOpt2,i=this.sort2,t.next=4,this.$http.post("Business/orderPay",rt(rt(rt(rt({},e),r),i),{},{type:this.memberpayTypesActive,group:a.sort((function(t,e){return t-e})),timeStart:e.time[0],timeEnd:e.time[1],appId:void 0}));case 4:if(o=t.sent,s=Object(n["a"])(o,2),l=s[0],c=s[1],!l){t.next=11;break}return this.tableData2.loading=!1,t.abrupt("return");case 11:for(f in this.tableData2.loading=!1,p=c.list,u=c.avg_list,h=c.sum_list,d=c.currentPage,m=c.total,p.forEach((function(t){for(var e in t)g.keyArr.indexOf(e)>=0&&t[e]&&(t[e]=(100*t[e]).toFixed(2)+"%"),g.numKeyArr.indexOf(e)>=0&&t[e]&&(t[e]=parseFloat(t[e]).toLocaleString())})),h)this.keyArr.indexOf(f)>=0&&h[f]&&(h[f]=(100*h[f]).toFixed(2)+"%"),this.numKeyArr.indexOf(f)>=0&&h[f]&&(h[f]=parseFloat(h[f]).toLocaleString());for(b in u)this.keyArr.indexOf(b)>=0&&u[b]&&(u[b]=(100*u[b]).toFixed(2)+"%"),this.numKeyArr.indexOf(b)>=0&&u[b]&&(u[b]=parseFloat(u[b]).toLocaleString());this.tableData2.data=p,this.tableData2currentPage=d,this.tableData2.total=m,this.sumList2=h,this.avgList2=u;case 21:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getParamDetail:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=1;case 1:if(!(e<4)){t.next=16;break}return t.next=4,this.$http.post("Business/paramDetail",{cate:4,timeStart:this.searchForm["time"][0],timeEnd:this.searchForm["time"][1],third_cate:e,appId:void 0});case 4:if(a=t.sent,r=Object(n["a"])(a,2),i=r[0],o=r[1],!i){t.next=10;break}return t.abrupt("return");case 10:o.showField.forEach((function(t){t.isSelect=!1})),o.hiddenField.forEach((function(t){t.isSelect=!1})),this["paramDetailData".concat(e)]=o;case 13:e++,t.next=1;break;case 16:this.memberpayTypesActiveTab=1,this.paramDetailData=this["paramDetailData1"],this.getParamDetailForList();case 19:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getParamDetailForList:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("Business/paramDetail",{cate:4,timeStart:this.searchForm["time"][0],timeEnd:this.searchForm["time"][1],third_cate:this.memberpayTypesActiveTab,appId:void 0});case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return");case 8:i.showField.forEach((function(t){t.isSelect=!1})),i.hiddenField.forEach((function(t){t.isSelect=!1})),this.paramDetailDataList=i;case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changeTable:function(t){this.getOrderPay()},changeDimensional:function(t){this.group=t?[1e3,1004,1005,1013,1015,1016]:[1e3],this.getOrderPay()},moveItem:function(t){var e=t.show,a=t.hidden,r={showField:e,hiddenField:a};this["paramDetailData".concat(this.memberpayTypesActiveTab)]=r},paramSave:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,o,s,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.tableData2.loading=!0,e=1;case 2:if(!(e<4)){t.next=17;break}return a=this["paramDetailData".concat(e)],r=a.showField.map((function(t){return t.field_id})),i=a.hiddenField.map((function(t){return t.field_id})),t.next=8,this.$http.post("Business/paramSave",{cate:4,timeStart:this.searchForm["time"][0],third_cate:e,second_cate:"",timeEnd:this.searchForm["time"][1],show:r,hidden:i,appId:void 0});case 8:if(o=t.sent,s=Object(n["a"])(o,2),l=s[0],s[1],!l){t.next=14;break}return t.abrupt("return");case 14:e++,t.next=2;break;case 17:this.getParamDetail(),this.getOrderPay();case 19:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),initData:function(){},memberpayTypeClickTabs:function(t){var e=this;this.memberpayTypesActiveTab!==t&&(this.memberpayTypesActiveTab=t,this.paramDetailData=this["paramDetailData".concat(t)],this.$nextTick((function(){e.$refs.transfer.init()})))},memberpayTypeClick:function(t){this.memberpayTypesActive!==t&&(this.memberpayTypesActive=t,this.paramDetailDataList=this["paramDetailData".concat(t)],this.getOrderPay())},orderpackageTypeClick:function(t){this.orderpackageActive!==t&&(this.orderpackageActive=t,this.getOrderPlan())},memberchangeTableList:function(){var t=this;2==this.memberpayTypesActive?this.group.forEach((function(e){t.column2.forEach((function(a){a.value==e&&(t.memberflexFlag?a.fixed="left":a.fixed=""),1e3==e&&t.memberflexFlag&&"week"==a.prop&&(a.fixed="left")}))})):3==this.memberpayTypesActive?this.group.forEach((function(e){t.column3.forEach((function(a){a.value==e&&(t.memberflexFlag?a.fixed="left":a.fixed=""),1e3==e&&t.memberflexFlag&&"week"==a.prop&&(a.fixed="left")}))})):this.group.forEach((function(e){t.column1.forEach((function(a){a.value==e&&(t.memberflexFlag?a.fixed="left":a.fixed=""),1e3==e&&t.memberflexFlag&&"week"==a.prop&&(a.fixed="left")}))}))}}},ot=it,nt=(a("ce63"),Object(I["a"])(ot,X,Z,!1,null,"74159bbe",null)),st=nt.exports,lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("FilterLayout",{attrs:{width:"100px",mdSpan:6,flexFlag:!0},on:{onSubmit:t.onSubmit},model:{value:t.searchForm,callback:function(e){t.searchForm=e},expression:"searchForm"}},[a("div",{staticClass:"component_title2"},[t._v("筛选项")]),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选部门",prop:"apartments"}},[a("SelectCustomize",{attrs:{value:t.departmentInfo,data:t.apartments},on:{changeScope:t.changeProjectTeam,clearData:t.getOrderFiltrate}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选项目组",prop:"project_group"}},[a("SelectCustomize",{attrs:{value:t.groupIdInfo,data:t.project_group},on:{changeScope:t.changeApp,clearData:t.getOrderFiltrate}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选项目",prop:"project"}},[a("SelectCustomize",{attrs:{value:t.projectInfo,data:t.article_id},on:{changeScope:t.changeArticle,clearData:t.getOrderFiltrate}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选应用",prop:"appid"}},[a("SelectChannel",{attrs:{paramFlag:"",optionsList:t.appId_options},on:{change:t.handleChange}})],1)],1),a("el-col",{attrs:{md:6,sm:12}},[a("el-form-item",{attrs:{label:"收入渠道",prop:"income"}},[a("SelectChannel",{attrs:{appId:t.searchForm.appid},model:{value:t.searchForm.channel,callback:function(e){t.$set(t.searchForm,"channel",e)},expression:"searchForm.channel"}})],1)],1),a("el-col",{attrs:{md:6,lg:6,sm:12}},[a("el-form-item",{attrs:{label:"复购周期"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchForm.day,callback:function(e){t.$set(t.searchForm,"day",e)},expression:"searchForm.day"}},t._l(t.Period,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),a("el-col",{attrs:{md:6,lg:6,sm:12}},[a("el-form-item",{attrs:{label:"复购次数"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchForm.cate,callback:function(e){t.$set(t.searchForm,"cate",e)},expression:"searchForm.cate"}},t._l(t.Fnum,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),1===t.searchForm.appid.length?a("el-col",{attrs:{md:6,lg:6,sm:12}},[a("el-form-item",{attrs:{label:"首购套餐"}},[a("SelectCustomize",{attrs:{value:t.first_pay_goods_idInfo,data:t.first_pay_goods_id},on:{changeScope:t.changefirst_pay_goods_id}})],1)],1):t._e(),a("el-col",{attrs:{md:6,lg:6,sm:12}},[a("el-form-item",{attrs:{label:"筛选时间"}},[a("dataPicker",{key:t.dateNum,attrs:{datevalue:t.searchForm.date},on:{"update:datevalue":function(e){return t.$set(t.searchForm,"date",e)}}})],1)],1),a("el-button",{attrs:{slot:"btn-option"},on:{click:t.initFrom},slot:"btn-option"},[t._v("重置筛选")])],1),a("TableLayout",{attrs:{column:t.changeColumn,data:t.tableData.data,total:t.tableData.total,loading:t.tableData.loading,currentPage:t.tableData.currentPage,author:"liuqiang",params:t.outPamrms,leadOut:!0,alignStyle:"center",leadApi:"Re_Purchase/NewRePurchaseList"},on:{pageChange:t.onPageChange,sizeChange:t.onSizeChange,sortChange:t.onSortChange}},[a("div",{staticClass:"component_title",attrs:{slot:"title"},slot:"title"},[t._v("新增复购情况表")])]),a("TableLayout",{attrs:{column:t.changeColumnMove,data:t.goodsRePurchaseTableData.data,total:t.goodsRePurchaseTableData.total,loading:t.goodsRePurchaseTableData.loading,author:"liuqiang",currentPage:t.goodsRePurchaseTableData.currentPage,params:t.outPamrmsMove,leadOut:!0,alignStyle:"center",leadApi:1==t.memberpayTypesActive?"Re_Purchase/GoodsRePurchaseList":"Re_Purchase/GoodsRePurchaseMoveList"},on:{pageChange:t.onGoodPageChange,sizeChange:t.onGoodSizeChange,sortChange:t.onGoodSortChange},scopedSlots:t._u([{key:"operate",fn:function(e){return[2==t.memberpayTypesActive&&e.row.move_goods_info.length>1?a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.changeTabelInfo(e)}}},[t._v("更多")]):t._e()]}}])},[2==t.memberpayTypesActive&&t.goodsRePurchaseTableData.data.length?a("div",{staticClass:"Tab_box",attrs:{slot:"table-option"},slot:"table-option"},[a("div",{staticClass:"left_box"},[a("el-checkbox",{staticStyle:{"margin-left":"20px"},model:{value:t.orderflexFlag,callback:function(e){t.orderflexFlag=e},expression:"orderflexFlag"}},[t._v("冻结维度项")])],1)]):t._e(),a("div",{staticClass:"table-tabs",attrs:{slot:"tabs"},slot:"tabs"},t._l(t.memberpayTypes,(function(e){return a("span",{key:e.id,staticClass:"items",class:t.memberpayTypesActive==e.id?"active":"",on:{click:function(a){return t.memberpayTypeClick(e.id)}}},[t._v("\n        "+t._s(e.label)+"\n      ")])})),0)]),a("el-dialog",{attrs:{title:"详情",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableInfo}},[a("el-table-column",{attrs:{prop:"goods_name",label:"迁移套餐名称",width:"180"}}),a("el-table-column",{attrs:{prop:"number",label:"迁移套餐用户数",width:"180"}}),a("el-table-column",{attrs:{prop:"cycle",label:"迁移占比"}})],1)],1)],1)},ct=[],pt=(a("c5f6"),a("84b4"),{data:function(){return{keyArr:["repurchase_rate","first_pay_user_rate","ql_cycle","cycle"],numKeyArr:["device_new","total_first_pay_user","people","ql_number","first_pay_user","number"],truncArr:["repurchase_price","money"],fourNumArr:["repurchase_cost"],Period:[{value:"1",label:"1日复购"},{value:"2",label:"2日复购"},{value:"3",label:"3日复购"},{value:"4",label:"4日复购"},{value:"5",label:"5日复购"},{value:"6",label:"6日复购"},{value:"7",label:"7日复购"},{value:"14",label:"14日复购"},{value:"30",label:"30日复购"},{value:"60",label:"60日复购"},{value:"90",label:"90日复购"},{value:"180",label:"180日复购"},{value:"365",label:"365日复购"}],Fnum:[{value:"1",label:"第一次复购"},{value:"2",label:"第二次复购"},{value:"3",label:"第三次复购"}],systemIds:[{id:"1",title:"Android"},{id:"2",title:"ios"},{id:"3",title:"小程序"}],apps:[],column:[{label:"时间",prop:"date"},{label:"新增",prop:"aaa"},{label:"首购总人数",prop:"bbb"},{label:"30日复购率",prop:"ccc"},{label:"30日复购客单价",prop:"ddd"},{label:"30日复购价值",prop:"eee"},{label:"30日复购人数",prop:"fff"},{label:"30日复购金额",prop:"ggg"}],Goodscolumn:[{label:"时间",prop:"date"},{label:"新增",prop:"aaa"},{label:"首购总人数",prop:"total_first_pay_user"},{label:"首购套餐名称",prop:"goods_name"},{label:"首购套餐人数",prop:"first_pay_user"},{prop:"first_pay_user_rate",label:"首购套餐占比"},{label:"30日复购率",prop:"ccc"},{label:"30日复购客单价",prop:"ddd"},{label:"30日复购价值",prop:"eee"},{label:"30日复购人数",prop:"fff"},{label:"30日复购金额",prop:"ggg"}],GoodsMovecolumn:[{label:"时间",prop:"date"},{label:"新增",prop:"aaa"},{label:"首购总人数",prop:"total_first_pay_user"},{label:"首购套餐名称",prop:"goods_name"},{label:"首购套餐人数",prop:"first_pay_user"},{prop:"first_pay_user_rate",label:"首购套餐占比"},{label:"30日复购率",prop:"ccc"},{label:"30日复购客单价",prop:"ddd"},{label:"30日复购价值",prop:"eee"},{label:"30日复购人数",prop:"fff"},{label:"30日复购金额",prop:"ggg"}],pickerOptions:{shortcuts:[{text:"昨天",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-864e5),t.$emit("pick",[a,e])}},{text:"近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"近30天",onClick:function(t){var e=h()().subtract(1,"months").format("YYYY-MM-DD"),a=h()().format("YYYY-MM-DD");t.$emit("pick",[e,a])}},{text:"近60天",onClick:function(t){var e=h()().subtract(2,"months").format("YYYY-MM-DD"),a=h()().format("YYYY-MM-DD");t.$emit("pick",[e,a])}},{text:"近90天",onClick:function(t){var e=h()().subtract(3,"months").format("YYYY-MM-DD"),a=h()().format("YYYY-MM-DD");t.$emit("pick",[e,a])}},{text:"本月",onClick:function(t){var e=new Date,a=e.getFullYear(),r=e.getMonth()+1,i=new Date(a+"-"+r+"-01");t.$emit("pick",[i,e])}},{text:"上个月",onClick:function(t){var e=h()().subtract(1,"months").endOf("month"),a=e.format("YYYY-MM-DD"),r=e.format("YYYY-MM-01");t.$emit("pick",[r,a])}}],disabledDate:function(t){return t.getTime()>Date.now()-864e5}},pickerOptions0:{disabledDate:function(t){return t.getTime()>Date.now()-864e5}}}}});function ut(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function ht(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(a),!0).forEach((function(e){Object(p["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ut(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var dt={mixins:[pt],components:{FilterLayout:g["a"],SelectCustomize:A["a"],TableLayout:_["a"],SelectChannel:et["a"]},data:function(){return{dialogVisible:!1,dateNum:1,tableInfo:[],searchForm:{project:[],appid:[],apartments:[],project_group:[],channel:[],day:"30",cate:"1",first_pay_goods_id:[],date:[h()().subtract(37,"d").format("YYYY-MM-DD"),h()().subtract(30,"d").format("YYYY-MM-DD")]},tableData:{data:[],total:0,currentPage:1,pageSize:10,loading:!1},goodsRePurchaseTableData:{data:[],total:0,currentPage:1,pageSize:10,loading:!1},tableOpt:{currentPage:1,pageSize:10},departmentInfo:{appInfo:[]},groupIdInfo:{appInfo:[]},projectInfo:{appInfo:[]},appidInfo:{appInfo:[]},incomeInfo:{appInfo:[]},first_pay_goods_idInfo:{appInfo:[]},apartments:[],project_group:[],article_id:[],first_pay_goods_id:[],ifirstorderIds:[{value:"",label:"全部"},{value:"1",label:"是"},{value:"0",label:"否"}],sort:{prop:"",order:""},orderflexFlag:!1,appId_options:[],props:{multiple:!0},goodsName:[],memberpayTypesActive:1,memberpayTypes:[{label:"套餐复购情况",id:1},{label:"套餐迁移情况",id:2}]}},mounted:function(){},computed:{outPamrms:function(){var t=this.searchForm;this.group,this.tableOpt;return ht(ht({},t),{},{currentPage:this.tableData.currentPage,pageSize:this.tableData.pageSize})},outPamrmsMove:function(){var t=this.searchForm;this.group,this.tableOpt;return ht(ht({},t),{},{leadeOutType:1==this.memberpayTypesActive?"":3,currentPage:this.goodsRePurchaseTableData.currentPage,pageSize:this.goodsRePurchaseTableData.pageSize})},changeColumn:function(){return this.column},changeColumnMove:function(){var t=Object(o["a"])(this.Goodscolumn);return this.orderflexFlag?(t.forEach((function(t){"date"==t.prop&&(t.fixed="left"),"week"==t.prop&&(t.fixed="left")})),t):(t.forEach((function(t){"date"==t.prop&&(t.fixed=""),"week"==t.prop&&(t.fixed="")})),t)}},methods:{getDashboardSetting:function(){this.getGoodsNameAll(),this.getReport(),this.getRoleBtree()},getGoodsNameAll:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("Re_Purchase/GetGoodsNameAll");case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return");case 8:this.goodsName=i;case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getRoleBtree:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,s,l,c,p,u,h,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={value:"1",label:"安卓",children:[]},a={value:"2",label:"ios",children:[]},r={value:"3",label:"微信小程序",children:[]},i={value:"4",label:"百度小程序",children:[]},t.next=6,this.$http.post("System/roleBtree",{loginId:m.a.get("user")["id"],loginToken:m.a.get("loginToken")});case 6:if(s=t.sent,l=Object(n["a"])(s,2),c=l[0],p=l[1],!c){t.next=12;break}return t.abrupt("return");case 12:this.apartments=p.tree,p.list.forEach((function(t){"应用"==t.title&&t.node.forEach((function(t){"1"==t.system?(t.title=t.title+"_Android",e.children.push({value:t.id,label:t.title})):"2"==t.system?(t.title=t.title+"_IOS",a.children.push({value:t.id,label:t.title})):"3"==t.system?(t.title=t.title+"_微信小程序",r.children.push({value:t.id,label:t.title})):"4"==t.system&&(t.title=t.title+"_百度小程序",i.children.push({value:t.id,label:t.title}))}))})),this.departDatas=[].concat(Object(o["a"])(p.list),[{id:1005,title:"系统",node:Object(o["a"])(this.systemIds)}]),u=[],p.tree.forEach((function(t){t.node.forEach((function(t){u.push(t)}))})),this.project_group=u,h=[],d=[],p.tree.forEach((function(t){t.node.forEach((function(t){d.push.apply(d,Object(o["a"])(t.node)),t.node.forEach((function(t){h.push.apply(h,Object(o["a"])(t.node))}))}))})),this.apps=h,this.article_id=d,this.appId_options=[e,a,r,i];case 24:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getOrderFiltrate:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("Business/orderFiltrate",ht(ht({},this.searchForm),{},{timeStart:this.searchForm.date[0],timeEnd:this.searchForm.date[1]}));case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return");case 8:i.forEach((function(t){1013==t.id?s.incomeIds=Object(o["a"])(t.children):1016==t.id&&(s.form_pathIds=Object(o["a"])(t.children))}));case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),changeProjectTeam:function(t){var e=this,a={value:"1",label:"安卓",children:[]},r={value:"2",label:"ios",children:[]},i={value:"3",label:"微信小程序",children:[]},n={value:"4",label:"百度小程序",children:[]};this.searchForm.apartments=t.appInfo,this.searchForm.project_group=[],this.searchForm.appid=[],this.searchForm.project=[],this.groupIdInfo.appInfo=[],this.projectInfo.appInfo=[],this.appidInfo.appInfo=[],this.incomeInfo.appInfo=[];var s=[],l=[],c=[];this.searchForm.apartments.forEach((function(t){e.apartments.forEach((function(e){t==e.id&&(s=[].concat(Object(o["a"])(e.node),Object(o["a"])(s)),e.node.forEach((function(t){c.push.apply(c,Object(o["a"])(t.node)),t.node.forEach((function(t){console.log(t),l.push.apply(l,Object(o["a"])(t.node))}))})))}))})),this.project_group=Object(o["a"])(s),this.article_id=[].concat(c),l.forEach((function(t){"1"==t.system?a.children.push({value:t.id,label:t.title}):"2"==t.system?r.children.push({value:t.id,label:t.title}):"3"==t.system?i.children.push({value:t.id,label:t.title}):"4"==t.system&&n.children.push({value:t.id,label:t.title})})),this.appId_options=[a,r,i,n],t.appInfo.length||this.getRoleBtree(),t&&0==t.appInfo.length&&(this.searchForm.apartments=[])},changeApp:function(t){var e=this,a={value:"1",label:"安卓",children:[]},r={value:"2",label:"ios",children:[]},i={value:"3",label:"微信小程序",children:[]},n={value:"4",label:"百度小程序",children:[]};this.searchForm.project_group=t.appInfo,this.searchForm.appid=[],this.searchForm.project=[],this.projectInfo.appInfo=[],this.appidInfo.appInfo=[],this.incomeInfo.appInfo=[];var s=[],l=[];this.searchForm.project_group.length?this.searchForm.project_group.forEach((function(t){e.apartments.forEach((function(e){e.node.forEach((function(e){t==e.id&&(l.push.apply(l,Object(o["a"])(e.node)),e.node.forEach((function(t){s.push.apply(s,Object(o["a"])(t.node))})))}))}))})):this.project_group.forEach((function(t){e.apartments.forEach((function(e){e.node.forEach((function(e){t.id==e.id&&(l.push.apply(l,Object(o["a"])(e.node)),e.node.forEach((function(t){s.push.apply(s,Object(o["a"])(t.node))})))}))}))})),s.forEach((function(t){"1"==t.system?a.children.push({value:t.id,label:t.title}):"2"==t.system?r.children.push({value:t.id,label:t.title}):"3"==t.system?i.children.push({value:t.id,label:t.title}):"4"==t.system&&n.children.push({value:t.id,label:t.title})})),this.appId_options=[a,r,i,n],this.article_id=[].concat(l),t&&0==t.appInfo.length&&(this.searchForm.project_group=[])},changeArticle:function(t){var e=this,a={value:"1",label:"安卓",children:[]},r={value:"2",label:"ios",children:[]},i={value:"3",label:"微信小程序",children:[]},n={value:"4",label:"百度小程序",children:[]};this.searchForm.project=t.appInfo,this.searchForm.appid=[],this.appidInfo.appInfo=[],this.incomeInfo.appInfo=[];var s=[];this.searchForm.project.length?this.searchForm.project.forEach((function(t){e.apartments.forEach((function(e){e.node.forEach((function(e){e.node.forEach((function(e){t==e.id&&s.push.apply(s,Object(o["a"])(e.node))}))}))}))})):this.article_id.forEach((function(t){s.push.apply(s,Object(o["a"])(t.node))})),s.forEach((function(t){"1"==t.system?a.children.push({value:t.id,label:t.title}):"2"==t.system?r.children.push({value:t.id,label:t.title}):"3"==t.system?i.children.push({value:t.id,label:t.title}):"4"==t.system&&n.children.push({value:t.id,label:t.title})})),this.appId_options=[a,r,i,n],t&&0==t.appInfo.length&&(this.searchForm.project=[])},handleChange:function(t){this.incomeInfo.appInfo=[],this.searchForm.channel=[];var e=[];t.forEach((function(t){e.push(t[1])})),this.searchForm.appid=e;var a=[];e.length&&this.goodsName.length&&this.goodsName.forEach((function(t){t.appid==e[0]&&t.goods_list.forEach((function(t){a.push({title:t.goods_name+"(".concat(t.goods_id,")"),id:t.goods_id})}))})),console.log(a),this.first_pay_goods_id=a},changefirst_pay_goods_id:function(t){this.searchForm.first_pay_goods_id=t.appInfo},onSubmit:function(){this.tableOpt.currentPage=1,this.goodsRePurchaseTableData.currentPage=1,this.getReport(),console.log(this.searchForm.appid.length),1==this.memberpayTypesActive&&1==this.searchForm.appid.length?this.getGoodsRePurchaseList():2==this.memberpayTypesActive&&1==this.searchForm.appid.length?this.getGoodsRePurchaseMove():this.goodsRePurchaseTableData={data:[],total:0,currentPage:1,pageSize:10,loading:!1}},initFrom:function(){this.searchForm={project:[],appid:[],apartments:[],project_group:[],channel:[],day:"30",cate:"1",first_pay_goods_id:[],date:[h()().subtract(7,"d").format("YYYY-MM-DD"),h()().subtract(1,"d").format("YYYY-MM-DD")]},this.searchForm.date=[h()().subtract(7,"d").format("YYYY-MM-DD"),h()().subtract(1,"d").format("YYYY-MM-DD")],this.dateNum++,this.getDashboardSetting()},onPageChange:function(t){this.tableData.currentPage=t,console.log(t),this.getReport()},onSizeChange:function(t){this.tableData.pageSize=t,this.getReport()},onSortChange:function(t){var e=t.prop,a=t.order;this.sort={prop:e,order:a},this.tableData.currentPage=1,this.getReport()},onGoodPageChange:function(t){this.goodsRePurchaseTableData.currentPage=t,1==this.memberpayTypesActive?this.getGoodsRePurchaseList():2==this.memberpayTypesActive&&this.getGoodsRePurchaseMove()},onGoodSizeChange:function(t){this.goodsRePurchaseTableData.pageSize=t,1==this.memberpayTypesActive?this.getGoodsRePurchaseList():2==this.memberpayTypesActive&&this.getGoodsRePurchaseMove()},onGoodSortChange:function(t){var e=t.prop,a=t.order;this.sort={prop:e,order:a},this.goodsRePurchaseTableData.currentPage=1,1==this.memberpayTypesActive?this.getGoodsRePurchaseList():2==this.memberpayTypesActive&&this.getGoodsRePurchaseMove()},getReport:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,s,l,c,p,u,d,m,f,b,g=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.tableData.loading=!0,this.column=[{label:"时间",prop:"date"},{label:"星期",prop:"week"},{label:"新增",prop:"device_new"},{label:"首购总人数",prop:"total_first_pay_user"},{prop:"repurchase_rate",label:this.searchForm.day+"日复购率"},{prop:"repurchase_price",label:this.searchForm.day+"日复购客单价"},{prop:"repurchase_cost",label:this.searchForm.day+"日复购价值"},{prop:"people",label:this.searchForm.day+"日复购人数"},{prop:"money",label:this.searchForm.day+"日复购金额"}],e=this.searchForm,this.group,this.tableOpt,t.next=5,this.$http.post("Re_Purchase/NewRePurchaseList",ht(ht({},e),{},{currentPage:this.tableData.currentPage,pageSize:this.tableData.pageSize}));case 5:if(a=t.sent,r=Object(n["a"])(a,2),i=r[0],s=r[1],!i){t.next=12;break}return this.tableData={data:[],total:0,currentPage:1,pageSize:10,loading:!1},t.abrupt("return");case 12:if(this.tableData.loading=!1,l=s.data,c=s.avg,p=s.sum,u=s.current_page,s.last_page,d=s.per_page,m=s.total,0!=l.length){t.next=17;break}return this.tableData={data:[],total:0,currentPage:1,pageSize:10,loading:!1},t.abrupt("return");case 17:for(f in p.date="总计",c.date="均值",{},l.forEach((function(t){for(var e in t)g.keyArr.indexOf(e)>=0&&(t[e]=(100*t[e]).toFixed(2)+"%"),-1!==g.numKeyArr.indexOf(e)&&(t[e]=parseFloat(Math.trunc(t[e])).toLocaleString()),-1!==g.truncArr.indexOf(e)&&(console.log(Number(t[e])),t[e]=parseFloat(Number(t[e]).toFixed(2)).toLocaleString()),g.fourNumArr.indexOf(e)>=0&&(t[e]=(1*t[e]).toFixed(4));t.week=h()(t.date).format("dddd")})),p)this.keyArr.indexOf(f)>=0&&(p[f]=(100*p[f]).toFixed(2)+"%"),-1!==this.numKeyArr.indexOf(f)&&(p[f]=parseFloat(Math.trunc(p[f])).toLocaleString()),-1!==this.truncArr.indexOf(f)&&(p[f]=parseFloat(Number(p[f]).toFixed(2)).toLocaleString()),this.fourNumArr.indexOf(f)>=0&&(p[f]=(1*p[f]).toFixed(4));for(b in c)this.keyArr.indexOf(b)>=0&&(c[b]=(100*c[b]).toFixed(2)+"%"),-1!==this.numKeyArr.indexOf(b)&&(c[b]=parseFloat(Math.trunc(c[b])).toLocaleString()),-1!==this.truncArr.indexOf(b)&&(c[b]=parseFloat(Number(c[b]).toFixed(2)).toLocaleString()),this.fourNumArr.indexOf(b)>=0&&(c[b]=(1*c[b]).toFixed(4));this.sumList=c,this.avgList=p,this.tableData.data=[p,c].concat(Object(o["a"])(l)),this.tableData.currentPage=u,this.tableData.pageSize=d,this.tableData.total=m;case 29:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getGoodsRePurchaseList:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,s,l,c,p,u,d,m,f,b,g=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.goodsRePurchaseTableData.loading=!0,this.Goodscolumn=[{label:"时间",prop:"date"},{label:"星期",prop:"week"},{label:"新增",prop:"device_new"},{label:"首购总人数",prop:"total_first_pay_user"},{label:"首购套餐名称",prop:"goods_name"},{label:"首购套餐人数",prop:"first_pay_user"},{prop:"first_pay_user_rate",label:"首购套餐占比"},{prop:"repurchase_rate",label:this.searchForm.day+"日复购率"},{prop:"repurchase_price",label:this.searchForm.day+"日复购客单价"},{prop:"repurchase_cost",label:this.searchForm.day+"日复购价值"},{prop:"people",label:this.searchForm.day+"日复购人数"},{prop:"money",label:this.searchForm.day+"日复购金额"}],e=this.searchForm,this.group,this.tableOpt,t.next=5,this.$http.post("Re_Purchase/GoodsRePurchaseList",ht(ht({},e),{},{currentPage:this.goodsRePurchaseTableData.currentPage,pageSize:this.goodsRePurchaseTableData.pageSize}));case 5:if(a=t.sent,r=Object(n["a"])(a,2),i=r[0],s=r[1],!i){t.next=12;break}return this.goodsRePurchaseTableData={data:[],total:0,currentPage:1,pageSize:10,loading:!1},t.abrupt("return");case 12:if(this.goodsRePurchaseTableData.loading=!1,l=s.data,c=s.avg,p=s.sum,u=s.current_page,s.last_page,d=s.per_page,m=s.total,0!=l.length){t.next=17;break}return this.goodsRePurchaseTableData.data=[],t.abrupt("return");case 17:for(f in p.date="总计",c.date="均值",{},l.forEach((function(t){for(var e in t)g.keyArr.indexOf(e)>=0&&(t[e]=(100*t[e]).toFixed(2)+"%"),-1!==g.numKeyArr.indexOf(e)&&(t[e]=parseFloat(Math.trunc(t[e])).toLocaleString()),-1!==g.truncArr.indexOf(e)&&(t[e]=parseFloat(Number(t[e]).toFixed(2)).toLocaleString()),g.fourNumArr.indexOf(e)>=0&&(t[e]=(1*t[e]).toFixed(4)),"goods_name"==e&&(t[e]="".concat(t[e],"(").concat(t["goods_id"],")"));t.week=h()(t.date).format("dddd")})),p)this.keyArr.indexOf(f)>=0&&(p[f]=(100*p[f]).toFixed(2)+"%"),-1!==this.numKeyArr.indexOf(f)&&(p[f]=parseFloat(Math.trunc(p[f])).toLocaleString()),-1!==this.truncArr.indexOf(f)&&(p[f]=parseFloat(Number(p[f]).toFixed(2)).toLocaleString()),this.fourNumArr.indexOf(f)>=0&&(p[f]=(1*p[f]).toFixed(4));for(b in c)this.keyArr.indexOf(b)>=0&&(c[b]=(100*c[b]).toFixed(2)+"%"),-1!==this.numKeyArr.indexOf(b)&&(c[b]=parseFloat(Math.trunc(c[b])).toLocaleString()),-1!==this.truncArr.indexOf(b)&&(c[b]=parseFloat(Number(c[b]).toFixed(2)).toLocaleString()),this.fourNumArr.indexOf(b)>=0&&(c[b]=(1*c[b]).toFixed(4));this.sumList=c,this.avgList=p,this.goodsRePurchaseTableData.data=[p,c].concat(Object(o["a"])(l)),this.goodsRePurchaseTableData.currentPage=u,this.goodsRePurchaseTableData.pageSize=d,this.goodsRePurchaseTableData.total=m;case 29:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getGoodsRePurchaseMove:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,s,l,c,p,u,d,m,f,b,g=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.goodsRePurchaseTableData.loading=!0,this.Goodscolumn=[{label:"时间",prop:"date"},{label:"星期",prop:"week"},{label:"新增",prop:"device_new"},{label:"首购总人数",prop:"total_first_pay_user"},{label:"首购套餐名称",prop:"goods_name"},{label:"首购套餐人数",prop:"first_pay_user"},{prop:"first_pay_user_rate",label:"首购套餐占比"},{prop:"repurchase_rate",label:this.searchForm.day+"日迁移复购率"},{prop:"repurchase_price",label:this.searchForm.day+"日迁移复购客单价"},{prop:"repurchase_cost",label:this.searchForm.day+"日迁移复购价值"},{prop:"people",label:this.searchForm.day+"日迁移复购人数"},{prop:"money",label:this.searchForm.day+"日迁移复购金额"},{prop:"ql_goods_name",label:"迁移套餐名称"},{prop:"ql_number",label:"迁移套餐用户数"},{prop:"ql_cycle",label:"迁移占比"},{prop:"operate",label:"操作"}],e=this.searchForm,this.group,this.tableOpt,t.next=5,this.$http.post("Re_Purchase/GoodsRePurchaseMoveList",ht(ht({},e),{},{currentPage:this.goodsRePurchaseTableData.currentPage,pageSize:this.goodsRePurchaseTableData.pageSize}));case 5:if(a=t.sent,r=Object(n["a"])(a,2),i=r[0],s=r[1],!i){t.next=12;break}return this.goodsRePurchaseTableData={data:[],total:0,currentPage:1,pageSize:10,loading:!1},t.abrupt("return");case 12:if(this.goodsRePurchaseTableData.loading=!1,l=s.data,c=s.avg,p=s.sum,u=s.current_page,s.last_page,d=s.per_page,m=s.total,0!=l.length){t.next=17;break}return this.goodsRePurchaseTableData={data:[],total:0,currentPage:1,pageSize:10,loading:!1},t.abrupt("return");case 17:for(f in l.forEach((function(t){t.move_goods_info.length&&(t.ql_goods_name=t.move_goods_info[0].goods_name,t.ql_number=t.move_goods_info[0].number,t.ql_cycle=t.move_goods_info[0].cycle)})),p.ql_goods_name=" ",p.ql_number=" ",p.ql_cycle=" ",p.move_goods_info=[],c.ql_goods_name=" ",c.ql_number=" ",c.ql_cycle=" ",c.move_goods_info=[],p.date="总计",c.date="均值",l.forEach((function(t){for(var e in t)g.keyArr.indexOf(e)>=0&&(t[e]=(100*t[e]).toFixed(2)+"%"),-1!==g.numKeyArr.indexOf(e)&&(t[e]=parseFloat(Math.trunc(t[e])).toLocaleString()),-1!==g.truncArr.indexOf(e)&&(t[e]=parseFloat(Number(t[e]).toFixed(2)).toLocaleString()),g.fourNumArr.indexOf(e)>=0&&(t[e]=(1*t[e]).toFixed(4)),"goods_name"==e&&(t[e]="".concat(t[e],"(").concat(t["goods_id"],")")),"ql_goods_name"==e&&(t[e]="".concat(t[e],"(").concat(t["goods_id"],")"));t.week=h()(t.date).format("dddd")})),p)this.keyArr.indexOf(f)>=0&&(p[f]=(100*p[f]).toFixed(2)+"%"),-1!==this.numKeyArr.indexOf(f)&&(p[f]=parseFloat(Math.trunc(p[f])).toLocaleString()),-1!==this.truncArr.indexOf(f)&&(p[f]=parseFloat(Number(p[f]).toFixed(2)).toLocaleString()),this.fourNumArr.indexOf(f)>=0&&(p[f]=(1*p[f]).toFixed(4));for(b in c)this.keyArr.indexOf(b)>=0&&(c[b]=(100*c[b]).toFixed(2)+"%"),-1!==this.numKeyArr.indexOf(b)&&(c[b]=parseFloat(Math.trunc(c[b])).toLocaleString()),-1!==this.truncArr.indexOf(b)&&(c[b]=parseFloat(Number(c[b]).toFixed(2)).toLocaleString()),this.fourNumArr.indexOf(b)>=0&&(c[b]=(1*c[b]).toFixed(4));this.sumList=c,this.avgList=p,this.goodsRePurchaseTableData.data=[p,c].concat(Object(o["a"])(l)),console.log(this.goodsRePurchaseTableData.data),this.goodsRePurchaseTableData.currentPage=u,this.goodsRePurchaseTableData.pageSize=d,this.goodsRePurchaseTableData.total=m;case 38:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),memberpayTypeClick:function(t){this.memberpayTypesActive!==t&&(this.memberpayTypesActive=t,this.goodsRePurchaseTableData.currentPage=1,1==t?this.getGoodsRePurchaseList():2==t&&this.getGoodsRePurchaseMove())},changeTabelInfo:function(t){for(var e=this,a=[],r=1;r<t.row.move_goods_info.length;r++)a.push(t.row.move_goods_info[r]);a=JSON.parse(JSON.stringify(a)),a.forEach((function(t){for(var a in t)e.keyArr.indexOf(a)>=0&&(console.log(t[a]),t[a]=(100*t[a]).toFixed(2)+"%"),-1!==e.numKeyArr.indexOf(a)&&(t[a]=parseFloat(Math.trunc(t[a])).toLocaleString()),-1!==e.truncArr.indexOf(a)&&(t[a]=parseFloat(Number(t[a]).toFixed(2)).toLocaleString()),e.fourNumArr.indexOf(a)>=0&&(t[a]=(1*t[a]).toFixed(4)),"goods_name"==a&&(t[a]="".concat(t[a],"(").concat(t["goods_id"],")"))})),console.log(a),this.tableInfo=a,this.dialogVisible=!0}}},mt=dt,ft=(a("43a7"),Object(I["a"])(mt,lt,ct,!1,null,"7b5fcbb0",null)),bt=ft.exports,gt={data:function(){return{radio:32,changeCheckList:[],checkList:[],dialogVisible:!1,DashboardSetting:[]}},components:{Index:$,Advertisement:Q,MemberDetails:st,PackageF:bt},mounted:function(){this.getDashboardSetting()},methods:{gotoIndex:function(){32!=this.radio&&(this.radio=32,this.getDashboardSetting())},gotoAdver:function(){33!=this.radio&&(this.radio=33,this.getDashboardSetting())},gotoMember:function(){41!=this.radio&&(this.radio=41,this.getDashboardSetting())},gotoPackage:function(){var t=this;42!=this.radio&&(this.radio=42,this.$nextTick((function(){t.$refs.index.getDashboardSetting()})))},getDashboardSetting:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("Business/dashboardSetting",{pid:this.radio});case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return");case 8:o=[],this.DashboardSetting=i,console.log(i),i.children.forEach((function(t){1==t.clicked&&o.push(t.id)})),this.changeCheckList=[].concat(o),this.checkList=[].concat(o),console.log(this.changeCheckList),this.$refs.index.getDashboardSetting();case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),resumeDashboardSetting:function(){this.checkList=Object(o["a"])(this.changeCheckList),this.dialogVisible=!1,41==this.radio?this.$refs.index.getOrderPlan():this.$refs.index.fetchCount(),41==this.radio?this.$refs.index.getOrderPay():this.$refs.index.getReport(),32==this.radio&&this.$refs.index.funnelEach()},saveBoardSetting:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("Business/saveBoardSetting",{setting_ids:this.checkList,pid:this.radio});case 2:if(e=t.sent,a=Object(n["a"])(e,2),r=a[0],a[1],!r){t.next=8;break}return t.abrupt("return");case 8:this.changeCheckList=Object(o["a"])(this.checkList),this.dialogVisible=!1,41==this.radio?this.$refs.index.getOrderPlan():this.$refs.index.fetchCount(),41==this.radio?this.$refs.index.getOrderPay():this.$refs.index.getReport(),32==this.radio&&this.$refs.index.funnelEach();case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},_t=gt,vt=(a("e2e8"),Object(I["a"])(_t,r,i,!1,null,"c6e575f6",null));e["default"]=vt.exports},"84b4":function(t,e,a){var r=a("5ca1");r(r.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},"85d8":function(t,e,a){},"8bb5":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"count-wrap"},[t._t("title"),a("div",{staticClass:"count-option"},[a("el-form",{attrs:{inline:!0}},[a("el-row",[t._t("option"),a("div",{staticClass:"cetent"},[t._t("cetent")],2)],2)],1),a("div",{staticClass:"extra"},[t._t("extra",(function(){return[Object.keys(t.countInfo).length?a("div",{staticClass:"tag"},[a("div",{staticClass:"tag-item"},[a("div",{staticClass:"name"},[t._v(t._s(t.countShow))]),a("div",{staticClass:"value"},[t._v(t._s(t.countInfo.total))])]),a("div",{staticClass:"tag-item"},[a("div",{staticClass:"name"},[t._v("平均:")]),a("div",{staticClass:"value"},[t._v(t._s(t.countInfo.avg))])])]):t._e()]}))],2),a("div",{staticClass:"extra"},[t._t("extras",(function(){return[t.countInfoArr.length<=2&&t.countInfoArr.length?a("div",{staticClass:"tags"},t._l(t.countInfoArr,(function(e,r){return a("div",{key:r,staticStyle:{display:"flex"}},[a("div",{staticClass:"tag-item",staticStyle:{"font-weight":"bolder"}},[t._v("\n              "+t._s(e.name)+"：\n            ")]),a("div",{staticClass:"tag-item"},[a("div",{staticClass:"name"},[t._v("合计")]),a("div",{staticClass:"value"},[t._v("\n                "+t._s(t._f("countInfoFilters")(e.total,e))+"\n              ")])]),a("div",{staticClass:"tag-item"},[a("div",{staticClass:"name"},[t._v("均值:")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("countInfoFilters")(e.avg,e)))])])])})),0):t._e(),t.countInfoArr.length>2&&t.countInfoArr.length?a("div",{staticClass:"tags"},[t._l(t.countInfoArr.slice(0,2),(function(e,r){return a("div",{key:r,staticStyle:{display:"flex"}},[a("div",{staticClass:"tag-item",staticStyle:{"font-weight":"bolder"}},[t._v("\n              "+t._s(e.name)+"：\n            ")]),a("div",{staticClass:"tag-item"},[a("div",{staticClass:"name"},[t._v("合计")]),a("div",{staticClass:"value"},[t._v("\n                "+t._s(t._f("countInfoFilters")(e.total,e))+"\n              ")])]),a("div",{staticClass:"tag-item"},[a("div",{staticClass:"name"},[t._v("均值:")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("countInfoFilters")(e.avg,e)))])])])})),a("el-dropdown",{staticStyle:{"z-index":"9999"}},[a("span",{staticClass:"el-dropdown-link"},[t._v("\n              详情"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.countInfoArr.slice(2),(function(e,r){return a("el-dropdown-item",{key:r},[t._v("\n                "+t._s(e.name)+"： 合计"+t._s(t._f("countInfoFilters")(e.total,e))+"，均值 "+t._s(t._f("countInfoFilters")(e.avg,e))+"\n              ")])})),1)],1)],2):t._e()]}))],2)],1),a("div",{ref:"count",staticStyle:{width:"100%",height:"400px"}}),t._t("option-two")],2)},i=[],o=(a("c5f6"),a("ac6a"),a("7f7f"),a("28a5"),a("c1df")),n=a.n(o),s=a("2ef0"),l=a.n(s),c={name:"countLayout",props:{type:{validator:function(t){return-1!==["line","bar","newBar","mix","newMix"].indexOf(t)},default:"line"},option:{type:Object,default:function(){return{}}},loading:{type:Boolean,default:!1},countInfo:{type:Object,default:function(){return{}}},countInfoArr:{type:Array,default:function(){return[]}}},data:function(){return{countShow:"合计:",$count:null}},mounted:function(){var t=this;this.$count=this.$echarts.init(this.$refs.count),window.onresize=function(){t.$count&&t.$count.resize()},"bar"!==this.type?"newBar"!==this.type?"mix"!==this.type?("newMix"===this.type&&this.drawNewMixCount(),this.drawCount()):this.drawMixCount():this.drawNewBarCount():this.drawBarCount()},watch:{option:function(t){"bar"!==this.type?"newBar"!==this.type?"mix"!==this.type?"newMix"!==this.type?this.drawCount(t):this.drawNewMixCount():this.drawMixCount():this.drawNewBarCount(t):this.drawBarCount(t)},loading:function(t){t?this.$count.showLoading():this.$count.hideLoading()}},filters:{countInfoFilters:function(t,e){var a=l.a.cloneDeep(t+"").split(".");return e.hasPercentSign?parseFloat(t).toLocaleString()+"%":parseFloat(t).toLocaleString("zh",{minimumFractionDigits:a.length>1?a[1].length:0})}},methods:{drawCount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.option,e=t.editData,a=t.legendData,r=void 0===a?[]:a,i=t.xAxisData,o=void 0===i?[]:i,s=t.data,l=void 0===s?[]:s,c=t.yName,p=void 0===c?"":c,u=t.yScale,h=void 0!==u&&u,d=t.formatter,m=void 0===d?function(t){return t}:d,f=t.xName,b=void 0===f?"":f;this.countShow="百分比"===p?"":"合计:";var g,_=this.type;if(e){var v=[];for(var y in l){var x={};for(var D in x.name=y,x.data=[],l[y])x.data.push(l[y][D]);v.push(x)}g=v.map((function(t){return{name:t.name,type:_,symbolSize:"7",smooth:!0,showAllSymbol:!0,hoverAnimation:!1,data:t.data.map((function(t,e){var a=o?n()(String(t.date)).format("E"):0;return{value:String(t.value),cycle:t.cycle,rate:t.rate,symbol:"6"===a||"7"===a?"circle":"emptyCircle"}}))}}))}else g=l.map((function(t){return{name:t.name,type:_,symbolSize:"7",smooth:!0,showAllSymbol:!0,hoverAnimation:!1,data:t.data.map((function(t,e){var a=o?n()(o[e]).format("E"):0;return{value:t,symbol:"6"===a||"7"===a?"circle":"emptyCircle"}}))}}));this.$count.clear(),this.$count.setOption({tooltip:{trigger:"axis",borderRadius:6,formatter:function(t){var a="".concat(t[0].name," <br/>");return t.length&&t.forEach((function(t){var r="百分比"===p?"%":"",i=void 0===t.data.rate?"":"同比：".concat(t.data.rate,"% 环比：").concat(t.data.cycle,"% <br/>");a+=e?t["seriesName"]+": "+m(t["value"])+r+"<br>"+i:t["seriesName"]+": "+m(t["value"])+"<br>"})),a}},noDataLoadingOption:{text:"暂无数据",effect:"bubble",effectOption:{effect:{n:0}}},legend:{data:r},grid:{left:"3%",right:"6%",bottom:"3%",containLabel:!0},xAxis:{type:"category",name:b,data:o,axisLabel:{fontSize:12,color:"#8C8C8C"}},yAxis:{type:"value",name:p,scale:h,splitLine:{lineStyle:{type:"dashed"}},axisLabel:{fontSize:13,color:"#8C8C8C",padding:[0,10,0,0],formatter:function(t){var e="百分比"===p?"%":"";return m&&m(t)+e}}},series:g})},drawBarCount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.option,e=t.xAxis,a=void 0===e?[]:e,r=t.yAxis,i=void 0===r?[]:r,o=t.series,n=void 0===o?[]:o,s=t.legend,l=void 0===s?[]:s,c=t.tooltip,p=void 0===c?{trigger:"axis",borderRadius:6}:c;this.$count.clear(),this.$count.setOption({color:["#3398DB"],tooltip:p,legend:l,grid:{left:"3%",right:"6%",bottom:"3%",containLabel:!0},xAxis:a,yAxis:i,series:n})},drawNewBarCount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.option,e=t.legendData,a=void 0===e?[]:e,r=t.xAxisData,i=void 0===r?[]:r,o=t.data,n=void 0===o?[]:o,s=t.yName,l=void 0===s?"":s,c=t.allName,p=void 0===c?"合计":c,u=t.yScale,h=void 0!==u&&u,d=t.formatter,m=void 0===d?function(t){if(t.length){var e="".concat(t[0].axisValueLabel,"<br/>"),a=0;return t.forEach((function(t){a+=Number(t.value),a=Number(a.toFixed(2)),e+="".concat(t.marker).concat(t.seriesName,"：").concat(t.value,"<br/>")})),p?e+"".concat(p,"：").concat(a.toFixed(2),"<br/>"):e}return""}:d,f=n.map((function(t){return{type:"bar",stack:"two",name:t.name,data:t.data,label:t.showlabel?{normal:{show:!0,position:"top",textStyle:{color:"#000"}}}:""}}));this.$count.clear(),this.$count.setOption({tooltip:{trigger:"axis",borderRadius:6,axisPointer:{type:"shadow"},formatter:function(t){return m(t)}},legend:{data:a},grid:{left:"3%",right:"6%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:i,axisLabel:{fontSize:12,color:"#8C8C8C"}},yAxis:{type:"value",name:l,scale:h,splitLine:{lineStyle:{type:"dashed"}},axisLabel:{fontSize:13,color:"#8C8C8C",padding:[0,10,0,0]}},color:["#5291EC","#16C06F","#FFC706","#8267DB","#FF6573"],series:f})},drawMixCount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.option,e=t.legendData,a=void 0===e?[]:e,r=t.xAxisData,i=void 0===r?[]:r,o=t.data,n=void 0===o?[]:o,s=t.yAxis,l=void 0===s?{}:s,c=t.formatter,p=void 0===c?function(t){if(t.length){var e="".concat(t[0].axisValueLabel,"<br/>"),a=0;return t.forEach((function(t){a+=Number(t.value),e+="".concat(t.marker).concat(t.seriesName,"：").concat(t.value,"<br/>")})),e+"合计：".concat(a,"<br/>")}return""}:c;this.$count.clear(),this.$count.setOption({tooltip:{trigger:"axis",borderRadius:6,axisPointer:{type:"shadow"},formatter:function(t){return p(t)}},legend:{data:a},grid:{left:"3%",right:"6%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:i,axisLabel:{fontSize:12,color:"#8C8C8C"}},yAxis:l,color:["#5291EC","#FFC706","#8267DB","#16C06F","#FF6573"],series:n})},drawNewMixCount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.option,e=t.legendData,a=void 0===e?[]:e,r=t.xAxisData,i=void 0===r?[]:r,o=t.data,s=void 0===o?[]:o,l=t.yAxis,c=void 0===l?{}:l,p=t.formatter,u=void 0===p?function(t){return""}:p;console.log(s);var h,d=["#FF981F","#5291ec"];h=s.map((function(t,e){return{name:t.name,type:"line",symbolSize:"7",smooth:!0,showAllSymbol:!0,hoverAnimation:!1,yAxisIndex:t.yAxisIndex,data:t.data.map((function(t,e){var a=i?n()(i[e]).format("E"):0;return{value:t,symbol:"6"===a||"7"===a?"circle":"emptyCircle"}})),itemStyle:1==s.length?{color:"#FF981F"}:2==s.length?{color:d[e]}:{}}})),console.log(h),this.$count.clear(),console.log(i,c),this.$count.setOption({tooltip:{trigger:"axis",formatter:function(t){return u(t)}},legend:{data:a},grid:{left:"3%",right:"6%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:i,axisLabel:{fontSize:12,color:"#8C8C8C"},axisTick:{alignWithLabel:!0}},yAxis:c,color:["#FFC706","#5291EC","#8267DB","#16C06F","#FF6573"],series:h})}}},p=c,u=(a("096b"),a("2877")),h=Object(u["a"])(p,r,i,!1,null,"504f9ee7",null);e["a"]=h.exports},a1de:function(t,e,a){"use strict";a("112f")},b265:function(t,e,a){},caaa:function(t,e,a){"use strict";a("3213")},ce63:function(t,e,a){"use strict";a("736f")},d655:function(t,e,a){"use strict";a("85d8")},d9ce:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-cascader-multi",{attrs:{data:t.options,clearable:"",filterable:"","collapse-tags":"","append-to-body":!1},on:{change:t.change},model:{value:t.insideValue,callback:function(e){t.insideValue=e},expression:"insideValue"}})],1)},i=[],o=(a("55dd"),a("3835")),n=(a("96cf"),a("1da1")),s=(a("ac6a"),a("c5f6"),{props:{value:{type:[String,Number,Array],default:""},haveAll:{type:Boolean,default:!0},optionsList:{type:Array,default:function(){return[]}},paramFlag:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},appId:{type:[String,Number,Array],default:function(){return[]}}},data:function(){return{myProps:{multiple:!0,value:"id",label:"title",children:"channels"},insideValue:[],options:[],optionsCopy:[],all:!1,channel:[]}},mounted:function(){this.paramFlag?this.opertionListFun(this.optionsList):this.channel.length?this.opertionListFun(this.channel):this.fetchChannel()},watch:{optionsList:{handler:function(){this.opertionListFun(this.optionsList)},deep:!0,immediate:!0},insideValue:function(t){if(t.length&&Array.isArray(t)){this.all=this.isSameArray(t,this.options);var e=[];t.forEach((function(t){e.push(t[1])})),this.$emit("input",e)}else this.$emit("input",t)},appId:function(t){this.fetchChannel(t)}},computed:{},methods:{opertionListFun:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=t.map((function(t){var e=[];return t.channels?e=t.channels.map((function(t){return{label:t||t.title||t.label,value:t||t.id||t.value}})):t.children&&(e=t.children.map((function(t){return{label:t.title||t.label,value:t.id||t.value}}))),{label:t.label||t.title,value:t.value||t.id,children:e}}));this.options=e,this.optionsCopy=e},fetchChannel:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,a,r,i,n,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=s.length>0&&void 0!==s[0]?s[0]:[],t.next=3,this.$http.post("income/getChannel",{app_id:e});case 3:if(a=t.sent,r=Object(o["a"])(a,2),i=r[0],n=r[1],!i){t.next=9;break}return t.abrupt("return");case 9:if(n.length){t.next=13;break}return this.options=[],this.optionsCopy=[],t.abrupt("return");case 13:this.opertionListFun(n);case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),change:function(t){this.$emit("change",t)},onFilter:function(t){this.options=t?this.optionsCopy.filter((function(e){if(~e.indexOf(t)||~e.toUpperCase().indexOf(t.toUpperCase()))return!0})):this.optionsCopy},onInputAll:function(t){this.insideValue=t?this.options:[]},isSameArray:function(t,e){var a=t.concat([]),r=e.concat([]),i=a.sort().join(""),o=r.sort().join("");return i===o}}}),l=s,c=(a("a1de"),a("2877")),p=Object(c["a"])(l,r,i,!1,null,"676fb47f",null);e["a"]=p.exports},e2e8:function(t,e,a){"use strict";a("0164")},efec:function(t,e,a){}}]);
//# sourceMappingURL=chunk-6e77cee1.1.0.0.1672021042960.js.map